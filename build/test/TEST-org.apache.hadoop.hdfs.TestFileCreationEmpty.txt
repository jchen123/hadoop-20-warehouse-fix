Testsuite: org.apache.hadoop.hdfs.TestFileCreationEmpty
Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 72.338 sec
------------- Standard Output ---------------
testLeaseExpireEmptyFiles start
2011-08-09 19:27:34,388 WARN  conf.Configuration (Configuration.java:<clinit>(191)) - DEPRECATED: hadoop-site.xml found in the classpath. Usage of hadoop-site.xml is deprecated. Instead use core-site.xml, mapred-site.xml and hdfs-site.xml to override properties of core-default.xml, mapred-default.xml and hdfs-default.xml respectively
2011-08-09 19:27:34,731 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 19:27:34,733 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 19:27:34,734 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 19:27:34,743 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 19:27:34,774 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 19:27:34,774 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 19:27:34,774 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 19:27:34,918 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 19:27:34,984 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 95 saved in 0 seconds.
2011-08-09 19:27:34,987 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/dfs/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 19:27:35,017 INFO  common.Storage (FSImage.java:format(1394)) - Storage directory /home/jeff/hadoop-20-warehouse/build/test/data/dfs/name1 has been successfully formatted.
2011-08-09 19:27:35,050 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 95 saved in 0 seconds.
2011-08-09 19:27:35,050 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/dfs/name2/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 19:27:35,062 INFO  common.Storage (FSImage.java:format(1394)) - Storage directory /home/jeff/hadoop-20-warehouse/build/test/data/dfs/name2 has been successfully formatted.
2011-08-09 19:27:35,080 INFO  jvm.JvmMetrics (JvmMetrics.java:init(71)) - Initializing JVM Metrics with processName=NameNode, sessionId=null
2011-08-09 19:27:35,149 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 19:27:35,150 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 19:27:35,150 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 19:27:35,153 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 19:27:35,153 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 19:27:35,227 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 19:27:35,228 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 19:27:35,228 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 19:27:35,228 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 19:27:35,254 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 19:27:35,255 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 19:27:35,268 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 19:27:35,275 INFO  common.Storage (FSImage.java:loadFSImage(1034)) - Number of files = 1
2011-08-09 19:27:35,276 INFO  common.Storage (FSImage.java:loadFilesUnderConstruction(1499)) - Number of files under construction = 0
2011-08-09 19:27:35,277 INFO  common.Storage (FSImage.java:loadFSImage(1144)) - Image file of size 95 loaded in 0 seconds.
2011-08-09 19:27:35,279 INFO  common.Storage (FSEditLog.java:loadFSEdits(886)) - Edits file /home/jeff/hadoop-20-warehouse/build/test/data/dfs/name1/current/edits of size 4 edits # 0 loaded in 0 seconds.
2011-08-09 19:27:35,280 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/dfs/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 19:27:35,281 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/dfs/name2/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 19:27:35,287 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2011-08-09 19:27:35,287 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(372)) - Finished loading FSImage in 61 msecs
2011-08-09 19:27:35,289 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(5294)) - initializing replication queues
2011-08-09 19:27:35,298 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4047)) - Total number of blocks = 0
2011-08-09 19:27:35,299 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4048)) - Number of invalid blocks = 0
2011-08-09 19:27:35,299 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4049)) - Number of under-replicated blocks = 0
2011-08-09 19:27:35,299 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4050)) - Number of  over-replicated blocks = 0
2011-08-09 19:27:35,300 INFO  hdfs.StateChange (FSNamesystem.java:leave(5269)) - STATE* Leaving safe mode after 0 secs.
2011-08-09 19:27:35,326 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 19:27:35,331 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=NameNode, port=57917
2011-08-09 19:27:35,336 INFO  namenode.NameNode (NameNode.java:startServerForClientRequests(396)) - Namenode up at: localhost/127.0.0.1:57917
2011-08-09 19:27:35,337 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 19:27:35,338 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 57917: starting
2011-08-09 19:27:35,339 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 57917: starting
2011-08-09 19:27:35,340 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 57917: starting
2011-08-09 19:27:35,340 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 57917: starting
2011-08-09 19:27:35,341 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 3 on 57917: starting
2011-08-09 19:27:35,378 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 5 on 57917: starting
2011-08-09 19:27:35,378 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 6 on 57917: starting
2011-08-09 19:27:35,379 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 7 on 57917: starting
2011-08-09 19:27:35,379 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 8 on 57917: starting
2011-08-09 19:27:35,381 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 4 on 57917: starting
2011-08-09 19:27:35,385 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 9 on 57917: starting
2011-08-09 19:27:35,481 WARN  fs.Trash (Trash.java:<init>(232)) - The configured interval for checkpoint is 0 minutes. Using interval of 0 minutes that is used for deletion instead
2011-08-09 19:27:35,482 INFO  hdfs.StateChange (FSNamesystem.java:leave(5283)) - STATE* Network topology has 0 racks and 0 datanodes
2011-08-09 19:27:35,482 INFO  hdfs.StateChange (FSNamesystem.java:leave(5286)) - STATE* UnderReplicatedBlocks has 0 blocks
2011-08-09 19:27:35,482 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(388)) - Skip counting items in the file tree
2011-08-09 19:27:35,490 INFO  util.HostsFileReader (HostsFileReader.java:refresh(80)) - Refreshing hosts (include/exclude) list
2011-08-09 19:27:35,569 INFO  mortbay.log (Slf4jLog.java:info(67)) - Logging to org.slf4j.impl.Log4jLoggerAdapter(org.mortbay.log) via org.mortbay.log.Slf4jLog
2011-08-09 19:27:35,644 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 19:27:35,652 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 19:27:35,653 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 60599 webServer.getConnectors()[0].getLocalPort() returned 60599
2011-08-09 19:27:35,653 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 60599
2011-08-09 19:27:35,653 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 19:27:36,175 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:60599
2011-08-09 19:27:36,176 INFO  namenode.NameNode (NameNode.java:startHttpServer(329)) - Web-server up at: localhost:60599
Starting DataNode 0 with dfs.data.dir: /home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data1,/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data2
2011-08-09 19:27:36,218 INFO  common.Storage (DataStorage.java:recoverTransitionRead(124)) - Storage directory /home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data1 is not formatted.
2011-08-09 19:27:36,218 INFO  common.Storage (DataStorage.java:recoverTransitionRead(125)) - Formatting ...
2011-08-09 19:27:36,236 INFO  common.Storage (DataStorage.java:recoverTransitionRead(124)) - Storage directory /home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data2 is not formatted.
2011-08-09 19:27:36,236 INFO  common.Storage (DataStorage.java:recoverTransitionRead(125)) - Formatting ...
2011-08-09 19:27:36,393 INFO  datanode.DataNode (FSDataset.java:registerMBean(1597)) - Registered FSDatasetStatusMBean
2011-08-09 19:27:36,395 INFO  datanode.DataNode (DataNode.java:startDataNode(327)) - Opened info server at 41204
2011-08-09 19:27:36,398 INFO  datanode.DataNode (DataXceiverServer.java:<init>(75)) - Balancing bandwith is 1048576 bytes/s
2011-08-09 19:27:36,404 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 19:27:36,407 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 19:27:36,407 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 50591 webServer.getConnectors()[0].getLocalPort() returned 50591
2011-08-09 19:27:36,408 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 50591
2011-08-09 19:27:36,408 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 19:27:36,572 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:50591
2011-08-09 19:27:36,574 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=DataNode, sessionId=null - already initialized
2011-08-09 19:27:36,582 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 19:27:36,584 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=DataNode, port=40382
2011-08-09 19:27:36,585 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 19:27:36,586 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 40382: starting
2011-08-09 19:27:36,609 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 40382: starting
2011-08-09 19:27:36,641 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 40382: starting
2011-08-09 19:27:36,641 INFO  datanode.DataNode (DataNode.java:startDataNode(418)) - dnRegistration = DatanodeRegistration(m3vm6.tuenti.local:41204, storageID=, infoPort=50591, ipcPort=40382)
2011-08-09 19:27:36,644 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 40382: starting
2011-08-09 19:28:38,927 INFO  hdfs.StateChange (FSNamesystem.java:registerDatanode(2757)) - BLOCK* NameSystem.registerDatanode: node registration from 127.0.0.1:41204 storage DS-861923441-10.0.62.238-41204-1312910918922
2011-08-09 19:28:38,931 INFO  net.NetworkTopology (NetworkTopology.java:add(328)) - Adding a new node: /default-rack/127.0.0.1:41204
2011-08-09 19:28:38,938 INFO  datanode.DataNode (DataNode.java:register(592)) - New storage id DS-861923441-10.0.62.238-41204-1312910918922 is assigned to data-node 127.0.0.1:41204
2011-08-09 19:28:38,939 INFO  datanode.DataNode (DataNode.java:run(1274)) - DatanodeRegistration(127.0.0.1:41204, storageID=DS-861923441-10.0.62.238-41204-1312910918922, infoPort=50591, ipcPort=40382)In DataNode.run, data = FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data1/current,/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data2/current'}
2011-08-09 19:28:38,940 INFO  datanode.DataNode (DataNode.java:offerService(756)) - using BLOCKREPORT_INTERVAL of 3600000msec Initial delay: 0msec
Starting DataNode 1 with dfs.data.dir: /home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data3,/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data4
2011-08-09 19:28:38,950 INFO  datanode.DataNode (FSDataset.java:getBlockInfo(601)) - Finished generating block report for 2 volumes in 0 seconds
2011-08-09 19:28:38,951 INFO  common.Storage (DataStorage.java:recoverTransitionRead(124)) - Storage directory /home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data3 is not formatted.
2011-08-09 19:28:38,951 INFO  common.Storage (DataStorage.java:recoverTransitionRead(125)) - Formatting ...
2011-08-09 19:28:38,952 INFO  hdfs.StateChange (FSNamesystem.java:processReport(3701)) - BLOCK* NameSystem.processReport: from 127.0.0.1:41204 0 blocks shortCircuit first report.
2011-08-09 19:28:38,953 INFO  datanode.DataNode (DataNode.java:offerService(839)) - BlockReport of 0 blocks got processed in 4 msecs
2011-08-09 19:28:38,953 INFO  datanode.DataNode (DataNode.java:offerService(864)) - Starting Periodic block scanner.
2011-08-09 19:28:38,954 INFO  datanode.DataNode (FSDataset.java:getBlockInfo(601)) - Finished generating block report for 2 volumes in 0 seconds
2011-08-09 19:28:38,967 INFO  common.Storage (DataStorage.java:recoverTransitionRead(124)) - Storage directory /home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data4 is not formatted.
2011-08-09 19:28:38,967 INFO  common.Storage (DataStorage.java:recoverTransitionRead(125)) - Formatting ...
2011-08-09 19:28:39,082 INFO  datanode.DataNode (FSDataset.java:registerMBean(1597)) - Registered FSDatasetStatusMBean
2011-08-09 19:28:39,084 INFO  datanode.DataNode (DataNode.java:startDataNode(327)) - Opened info server at 60845
2011-08-09 19:28:39,084 INFO  datanode.DataNode (DataXceiverServer.java:<init>(75)) - Balancing bandwith is 1048576 bytes/s
2011-08-09 19:28:39,091 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 19:28:39,092 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 19:28:39,101 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 57286 webServer.getConnectors()[0].getLocalPort() returned 57286
2011-08-09 19:28:39,101 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 57286
2011-08-09 19:28:39,101 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 19:28:39,331 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:57286
2011-08-09 19:28:39,374 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=DataNode, sessionId=null - already initialized
2011-08-09 19:28:39,396 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 19:28:39,398 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=DataNode, port=57969
2011-08-09 19:28:39,399 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 19:28:39,443 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 57969: starting
2011-08-09 19:28:39,443 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 57969: starting
2011-08-09 19:28:39,443 INFO  datanode.DataNode (DataNode.java:startDataNode(418)) - dnRegistration = DatanodeRegistration(m3vm6.tuenti.local:60845, storageID=, infoPort=57286, ipcPort=57969)
2011-08-09 19:28:39,444 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 57969: starting
2011-08-09 19:28:39,445 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 57969: starting
2011-08-09 19:28:39,460 INFO  hdfs.StateChange (FSNamesystem.java:registerDatanode(2757)) - BLOCK* NameSystem.registerDatanode: node registration from 127.0.0.1:60845 storage DS-223716937-10.0.62.238-60845-1312910919447
2011-08-09 19:28:39,460 INFO  net.NetworkTopology (NetworkTopology.java:add(328)) - Adding a new node: /default-rack/127.0.0.1:60845
2011-08-09 19:28:39,468 INFO  datanode.DataNode (DataNode.java:register(592)) - New storage id DS-223716937-10.0.62.238-60845-1312910919447 is assigned to data-node 127.0.0.1:60845
Starting DataNode 2 with dfs.data.dir: /home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data5,/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data6
2011-08-09 19:28:39,470 INFO  datanode.DataNode (DataNode.java:run(1274)) - DatanodeRegistration(127.0.0.1:60845, storageID=DS-223716937-10.0.62.238-60845-1312910919447, infoPort=57286, ipcPort=57969)In DataNode.run, data = FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data3/current,/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data4/current'}
2011-08-09 19:28:39,476 INFO  datanode.DataNode (DataNode.java:offerService(756)) - using BLOCKREPORT_INTERVAL of 3600000msec Initial delay: 0msec
2011-08-09 19:28:39,478 INFO  common.Storage (DataStorage.java:recoverTransitionRead(124)) - Storage directory /home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data5 is not formatted.
2011-08-09 19:28:39,478 INFO  common.Storage (DataStorage.java:recoverTransitionRead(125)) - Formatting ...
2011-08-09 19:28:39,497 INFO  common.Storage (DataStorage.java:recoverTransitionRead(124)) - Storage directory /home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data6 is not formatted.
2011-08-09 19:28:39,497 INFO  common.Storage (DataStorage.java:recoverTransitionRead(125)) - Formatting ...
2011-08-09 19:28:39,629 INFO  datanode.DataNode (FSDataset.java:getBlockInfo(601)) - Finished generating block report for 2 volumes in 0 seconds
2011-08-09 19:28:39,632 INFO  hdfs.StateChange (FSNamesystem.java:processReport(3701)) - BLOCK* NameSystem.processReport: from 127.0.0.1:60845 0 blocks shortCircuit first report.
2011-08-09 19:28:39,638 INFO  datanode.DataNode (DataNode.java:offerService(839)) - BlockReport of 0 blocks got processed in 10 msecs
2011-08-09 19:28:39,638 INFO  datanode.DataNode (DataNode.java:offerService(864)) - Starting Periodic block scanner.
2011-08-09 19:28:39,646 INFO  datanode.DataNode (FSDataset.java:getBlockInfo(601)) - Finished generating block report for 2 volumes in 0 seconds
2011-08-09 19:28:39,707 INFO  datanode.DataNode (FSDataset.java:registerMBean(1597)) - Registered FSDatasetStatusMBean
2011-08-09 19:28:39,709 INFO  datanode.DataNode (DataNode.java:startDataNode(327)) - Opened info server at 43658
2011-08-09 19:28:39,709 INFO  datanode.DataNode (DataXceiverServer.java:<init>(75)) - Balancing bandwith is 1048576 bytes/s
2011-08-09 19:28:39,712 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 19:28:39,713 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 19:28:39,714 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 47982 webServer.getConnectors()[0].getLocalPort() returned 47982
2011-08-09 19:28:39,714 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 47982
2011-08-09 19:28:39,715 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 19:28:39,979 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:47982
2011-08-09 19:28:39,981 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=DataNode, sessionId=null - already initialized
2011-08-09 19:28:39,986 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 19:28:39,988 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=DataNode, port=33187
2011-08-09 19:28:39,989 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 19:28:39,989 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 33187: starting
2011-08-09 19:28:40,032 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 33187: starting
2011-08-09 19:28:40,074 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 33187: starting
2011-08-09 19:28:40,073 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 33187: starting
2011-08-09 19:28:40,074 INFO  datanode.DataNode (DataNode.java:startDataNode(418)) - dnRegistration = DatanodeRegistration(m3vm6.tuenti.local:43658, storageID=, infoPort=47982, ipcPort=33187)
2011-08-09 19:28:40,078 INFO  hdfs.StateChange (FSNamesystem.java:registerDatanode(2757)) - BLOCK* NameSystem.registerDatanode: node registration from 127.0.0.1:43658 storage DS-144832081-10.0.62.238-43658-1312910920077
2011-08-09 19:28:40,078 INFO  net.NetworkTopology (NetworkTopology.java:add(328)) - Adding a new node: /default-rack/127.0.0.1:43658
2011-08-09 19:28:40,084 INFO  datanode.DataNode (DataNode.java:register(592)) - New storage id DS-144832081-10.0.62.238-43658-1312910920077 is assigned to data-node 127.0.0.1:43658
2011-08-09 19:28:40,086 INFO  datanode.DataNode (DataNode.java:run(1274)) - DatanodeRegistration(127.0.0.1:43658, storageID=DS-144832081-10.0.62.238-43658-1312910920077, infoPort=47982, ipcPort=33187)In DataNode.run, data = FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data5/current,/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data6/current'}
2011-08-09 19:28:40,129 INFO  datanode.DataNode (DataNode.java:offerService(756)) - using BLOCKREPORT_INTERVAL of 3600000msec Initial delay: 0msec
2011-08-09 19:28:40,159 INFO  datanode.DataNode (FSDataset.java:getBlockInfo(601)) - Finished generating block report for 2 volumes in 0 seconds
2011-08-09 19:28:40,168 INFO  hdfs.StateChange (FSNamesystem.java:processReport(3701)) - BLOCK* NameSystem.processReport: from 127.0.0.1:43658 0 blocks shortCircuit first report.
2011-08-09 19:28:40,176 INFO  datanode.DataNode (DataNode.java:offerService(839)) - BlockReport of 0 blocks got processed in 38 msecs
2011-08-09 19:28:40,189 INFO  datanode.DataNode (DataNode.java:offerService(864)) - Starting Periodic block scanner.
2011-08-09 19:28:40,190 INFO  datanode.DataNode (FSDataset.java:getBlockInfo(601)) - Finished generating block report for 2 volumes in 0 seconds
createFile: Created /foo with 3 replica.
2011-08-09 19:28:40,216 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 2 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 0 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/dfs/name1/current/edits:0  /home/jeff/hadoop-20-warehouse/build/test/data/dfs/name2/current/edits:0 
2011-08-09 19:28:40,224 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditEvent(136)) - ugi=jeff,jeff	ip=/127.0.0.1	cmd=create	src=/foo	dst=null	perm=jeff:supergroup:rw-r--r--
createFile: Created /foo2 with 3 replica.
2011-08-09 19:28:40,231 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditEvent(136)) - ugi=jeff,jeff	ip=/127.0.0.1	cmd=create	src=/foo2	dst=null	perm=jeff:supergroup:rw-r--r--
createFile: Created /foo3 with 3 replica.
2011-08-09 19:28:40,236 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditEvent(136)) - ugi=jeff,jeff	ip=/127.0.0.1	cmd=create	src=/foo3	dst=null	perm=jeff:supergroup:rw-r--r--
2011-08-09 19:28:42,237 INFO  namenode.LeaseManager (LeaseManager.java:checkLeases(389)) - Lease [Lease.  Holder: DFSClient_571931082, pendingcreates: 3] has expired hard limit
2011-08-09 19:28:42,237 INFO  namenode.FSNamesystem (FSNamesystem.java:internalReleaseLease(2452)) - Recovering lease=[Lease.  Holder: DFSClient_571931082, pendingcreates: 3], src=/foo
2011-08-09 19:28:42,238 WARN  hdfs.StateChange (FSNamesystem.java:internalReleaseLease(2479)) - BLOCK* internalReleaseLease: No blocks found, lease removed.
2011-08-09 19:28:42,238 INFO  namenode.FSNamesystem (FSNamesystem.java:internalReleaseLease(2452)) - Recovering lease=[Lease.  Holder: DFSClient_571931082, pendingcreates: 2], src=/foo2
2011-08-09 19:28:42,239 WARN  hdfs.StateChange (FSNamesystem.java:internalReleaseLease(2479)) - BLOCK* internalReleaseLease: No blocks found, lease removed.
2011-08-09 19:28:42,239 INFO  namenode.FSNamesystem (FSNamesystem.java:internalReleaseLease(2452)) - Recovering lease=[Lease.  Holder: DFSClient_571931082, pendingcreates: 1], src=/foo3
2011-08-09 19:28:42,239 WARN  hdfs.StateChange (FSNamesystem.java:internalReleaseLease(2479)) - BLOCK* internalReleaseLease: No blocks found, lease removed.
Shutting down the Mini HDFS Cluster
Shutting down DataNode 2
2011-08-09 19:28:45,413 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 19:28:45,417 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 33187
2011-08-09 19:28:45,417 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 33187: exiting
2011-08-09 19:28:45,418 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 33187: exiting
2011-08-09 19:28:45,418 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 33187: exiting
2011-08-09 19:28:45,418 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 33187
2011-08-09 19:28:45,422 WARN  datanode.DataNode (DataXceiverServer.java:run(138)) - DatanodeRegistration(127.0.0.1:43658, storageID=DS-144832081-10.0.62.238-43658-1312910920077, infoPort=47982, ipcPort=33187):DataXceiveServer: java.nio.channels.AsynchronousCloseException
	at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:152)
	at sun.nio.ch.ServerSocketAdaptor.accept(ServerSocketAdaptor.java:84)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiverServer.run(DataXceiverServer.java:131)
	at java.lang.Thread.run(Thread.java:662)

2011-08-09 19:28:45,422 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 19:28:45,423 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 1
2011-08-09 19:28:45,423 INFO  datanode.DataBlockScanner (DataBlockScanner.java:run(604)) - Exiting DataBlockScanner thread.
2011-08-09 19:28:45,424 INFO  datanode.DataNode (DataNode.java:run(1294)) - DatanodeRegistration(127.0.0.1:43658, storageID=DS-144832081-10.0.62.238-43658-1312910920077, infoPort=47982, ipcPort=33187):Finishing DataNode in: FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data5/current,/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data6/current'}
2011-08-09 19:28:45,424 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 33187
2011-08-09 19:28:45,425 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 19:28:45,426 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(128)) - Shutting down all async disk service threads...
2011-08-09 19:28:45,426 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(137)) - All async disk service threads have been shut down.
2011-08-09 19:28:45,427 WARN  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(125)) - AsyncDiskService has already shut down.
Shutting down DataNode 1
2011-08-09 19:28:45,497 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 19:28:45,498 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 57969
2011-08-09 19:28:45,499 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 57969: exiting
2011-08-09 19:28:45,499 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 57969: exiting
2011-08-09 19:28:45,500 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 57969
2011-08-09 19:28:45,501 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 57969: exiting
2011-08-09 19:28:45,502 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 1
2011-08-09 19:28:45,502 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 19:28:45,504 WARN  datanode.DataNode (DataXceiverServer.java:run(138)) - DatanodeRegistration(127.0.0.1:60845, storageID=DS-223716937-10.0.62.238-60845-1312910919447, infoPort=57286, ipcPort=57969):DataXceiveServer: java.nio.channels.AsynchronousCloseException
	at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:152)
	at sun.nio.ch.ServerSocketAdaptor.accept(ServerSocketAdaptor.java:84)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiverServer.run(DataXceiverServer.java:131)
	at java.lang.Thread.run(Thread.java:662)

2011-08-09 19:28:45,648 INFO  datanode.DataBlockScanner (DataBlockScanner.java:run(604)) - Exiting DataBlockScanner thread.
2011-08-09 19:28:46,483 INFO  datanode.DataNode (DataNode.java:run(1294)) - DatanodeRegistration(127.0.0.1:60845, storageID=DS-223716937-10.0.62.238-60845-1312910919447, infoPort=57286, ipcPort=57969):Finishing DataNode in: FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data3/current,/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data4/current'}
2011-08-09 19:28:46,484 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 57969
2011-08-09 19:28:46,484 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 19:28:46,485 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(128)) - Shutting down all async disk service threads...
2011-08-09 19:28:46,485 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(137)) - All async disk service threads have been shut down.
2011-08-09 19:28:46,502 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 19:28:46,503 WARN  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(125)) - AsyncDiskService has already shut down.
Shutting down DataNode 0
2011-08-09 19:28:46,521 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 19:28:46,522 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 40382
2011-08-09 19:28:46,523 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 40382: exiting
2011-08-09 19:28:46,523 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 40382: exiting
2011-08-09 19:28:46,523 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 40382: exiting
2011-08-09 19:28:46,523 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 40382
2011-08-09 19:28:46,527 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 19:28:46,527 WARN  datanode.DataNode (DataXceiverServer.java:run(138)) - DatanodeRegistration(127.0.0.1:41204, storageID=DS-861923441-10.0.62.238-41204-1312910918922, infoPort=50591, ipcPort=40382):DataXceiveServer: java.nio.channels.AsynchronousCloseException
	at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:152)
	at sun.nio.ch.ServerSocketAdaptor.accept(ServerSocketAdaptor.java:84)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiverServer.run(DataXceiverServer.java:131)
	at java.lang.Thread.run(Thread.java:662)

2011-08-09 19:28:46,528 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 19:28:46,528 INFO  datanode.DataBlockScanner (DataBlockScanner.java:run(604)) - Exiting DataBlockScanner thread.
2011-08-09 19:28:46,529 INFO  datanode.DataNode (DataNode.java:run(1294)) - DatanodeRegistration(127.0.0.1:41204, storageID=DS-861923441-10.0.62.238-41204-1312910918922, infoPort=50591, ipcPort=40382):Finishing DataNode in: FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data1/current,/home/jeff/hadoop-20-warehouse/build/test/data/dfs/data/data2/current'}
2011-08-09 19:28:46,529 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 40382
2011-08-09 19:28:46,529 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 19:28:46,530 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(128)) - Shutting down all async disk service threads...
2011-08-09 19:28:46,530 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(137)) - All async disk service threads have been shut down.
2011-08-09 19:28:46,531 WARN  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(125)) - AsyncDiskService has already shut down.
2011-08-09 19:28:46,574 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 19:28:46,576 WARN  namenode.FSNamesystem (FSNamesystem.java:run(3042)) - ReplicationMonitor thread received InterruptedException.java.lang.InterruptedException: sleep interrupted
2011-08-09 19:28:46,577 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 9 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 3 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/dfs/name1/current/edits:6  /home/jeff/hadoop-20-warehouse/build/test/data/dfs/name2/current/edits:4 
2011-08-09 19:28:46,578 INFO  namenode.DecommissionManager (DecommissionManager.java:waitForWork(254)) - Interrupted Monitor
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.waitForWork(DecommissionManager.java:244)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.run(DecommissionManager.java:267)
	at java.lang.Thread.run(Thread.java:662)
2011-08-09 19:28:46,579 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 57917
2011-08-09 19:28:46,580 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 5 on 57917: exiting
2011-08-09 19:28:46,580 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 9 on 57917: exiting
2011-08-09 19:28:46,580 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 57917
2011-08-09 19:28:46,581 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 19:28:46,581 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 57917: exiting
2011-08-09 19:28:46,581 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 8 on 57917: exiting
2011-08-09 19:28:46,581 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 57917: exiting
2011-08-09 19:28:46,582 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 7 on 57917: exiting
2011-08-09 19:28:46,581 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 3 on 57917: exiting
2011-08-09 19:28:46,582 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 6 on 57917: exiting
------------- ---------------- ---------------

Testcase: testLeaseExpireEmptyFiles took 72.317 sec
