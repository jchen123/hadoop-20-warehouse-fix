Testsuite: org.apache.hadoop.hdfs.TestDFSRollback
Tests run: 1, Failures: 0, Errors: 0, Time elapsed: 18.737 sec
------------- Standard Output ---------------
2011-08-09 18:49:37,388 WARN  conf.Configuration (Configuration.java:<clinit>(191)) - DEPRECATED: hadoop-site.xml found in the classpath. Usage of hadoop-site.xml is deprecated. Instead use core-site.xml, mapred-site.xml and hdfs-site.xml to override properties of core-default.xml, mapred-default.xml and hdfs-default.xml respectively
2011-08-09 18:49:37,644 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:37,645 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:37,646 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:37,655 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:37,730 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:37,731 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:37,731 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:37,923 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:38,013 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 95 saved in 0 seconds.
2011-08-09 18:49:38,017 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/namenodeMaster/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:38,090 INFO  common.Storage (FSImage.java:format(1394)) - Storage directory /home/jeff/hadoop-20-warehouse/build/test/data/namenodeMaster has been successfully formatted.
2011-08-09 18:49:38,125 INFO  jvm.JvmMetrics (JvmMetrics.java:init(71)) - Initializing JVM Metrics with processName=NameNode, sessionId=null
2011-08-09 18:49:38,194 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:38,195 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:38,195 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:38,195 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:38,196 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:38,270 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:38,270 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:38,270 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:38,271 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:38,297 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:38,298 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:38,307 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:38,314 INFO  common.Storage (FSImage.java:loadFSImage(1034)) - Number of files = 1
2011-08-09 18:49:38,314 INFO  common.Storage (FSImage.java:loadFilesUnderConstruction(1499)) - Number of files under construction = 0
2011-08-09 18:49:38,315 INFO  common.Storage (FSImage.java:loadFSImage(1144)) - Image file of size 95 loaded in 0 seconds.
2011-08-09 18:49:38,317 INFO  common.Storage (FSEditLog.java:loadFSEdits(886)) - Edits file /home/jeff/hadoop-20-warehouse/build/test/data/namenodeMaster/current/edits of size 4 edits # 0 loaded in 0 seconds.
2011-08-09 18:49:38,318 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/namenodeMaster/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:38,324 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2011-08-09 18:49:38,324 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(372)) - Finished loading FSImage in 56 msecs
2011-08-09 18:49:38,326 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(5294)) - initializing replication queues
2011-08-09 18:49:38,336 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4047)) - Total number of blocks = 0
2011-08-09 18:49:38,336 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4048)) - Number of invalid blocks = 0
2011-08-09 18:49:38,337 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4049)) - Number of under-replicated blocks = 0
2011-08-09 18:49:38,337 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4050)) - Number of  over-replicated blocks = 0
2011-08-09 18:49:38,337 INFO  hdfs.StateChange (FSNamesystem.java:leave(5269)) - STATE* Leaving safe mode after 0 secs.
2011-08-09 18:49:38,363 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:38,367 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=NameNode, port=42605
2011-08-09 18:49:38,371 INFO  namenode.NameNode (NameNode.java:startServerForClientRequests(396)) - Namenode up at: localhost/127.0.0.1:42605
2011-08-09 18:49:38,372 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:38,373 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 42605: starting
2011-08-09 18:49:38,374 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 42605: starting
2011-08-09 18:49:38,374 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 42605: starting
2011-08-09 18:49:38,375 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 42605: starting
2011-08-09 18:49:38,375 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 3 on 42605: starting
2011-08-09 18:49:38,375 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 4 on 42605: starting
2011-08-09 18:49:38,376 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 5 on 42605: starting
2011-08-09 18:49:38,376 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 6 on 42605: starting
2011-08-09 18:49:38,377 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 7 on 42605: starting
2011-08-09 18:49:38,377 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 8 on 42605: starting
2011-08-09 18:49:38,388 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 9 on 42605: starting
2011-08-09 18:49:38,518 WARN  fs.Trash (Trash.java:<init>(232)) - The configured interval for checkpoint is 0 minutes. Using interval of 0 minutes that is used for deletion instead
2011-08-09 18:49:38,519 INFO  hdfs.StateChange (FSNamesystem.java:leave(5283)) - STATE* Network topology has 0 racks and 0 datanodes
2011-08-09 18:49:38,519 INFO  hdfs.StateChange (FSNamesystem.java:leave(5286)) - STATE* UnderReplicatedBlocks has 0 blocks
2011-08-09 18:49:38,520 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(388)) - Skip counting items in the file tree
2011-08-09 18:49:38,529 INFO  util.HostsFileReader (HostsFileReader.java:refresh(80)) - Refreshing hosts (include/exclude) list
2011-08-09 18:49:38,642 INFO  mortbay.log (Slf4jLog.java:info(67)) - Logging to org.slf4j.impl.Log4jLoggerAdapter(org.mortbay.log) via org.mortbay.log.Slf4jLog
2011-08-09 18:49:38,727 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:38,766 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:38,767 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 51309 webServer.getConnectors()[0].getLocalPort() returned 51309
2011-08-09 18:49:38,767 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 51309
2011-08-09 18:49:38,768 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:39,209 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:51309
2011-08-09 18:49:39,210 INFO  namenode.NameNode (NameNode.java:startHttpServer(329)) - Web-server up at: localhost:51309
Starting DataNode 0 with dfs.data.dir: /home/jeff/hadoop-20-warehouse/build/test/data/datanodeMaster
2011-08-09 18:49:39,330 INFO  common.Storage (DataStorage.java:recoverTransitionRead(124)) - Storage directory /home/jeff/hadoop-20-warehouse/build/test/data/datanodeMaster is not formatted.
2011-08-09 18:49:39,330 INFO  common.Storage (DataStorage.java:recoverTransitionRead(125)) - Formatting ...
2011-08-09 18:49:39,416 INFO  datanode.DataNode (FSDataset.java:registerMBean(1597)) - Registered FSDatasetStatusMBean
2011-08-09 18:49:39,418 INFO  datanode.DataNode (DataNode.java:startDataNode(327)) - Opened info server at 56645
2011-08-09 18:49:39,421 INFO  datanode.DataNode (DataXceiverServer.java:<init>(75)) - Balancing bandwith is 1048576 bytes/s
2011-08-09 18:49:39,428 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:39,431 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:39,431 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 45198 webServer.getConnectors()[0].getLocalPort() returned 45198
2011-08-09 18:49:39,432 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 45198
2011-08-09 18:49:39,432 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:39,732 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:45198
2011-08-09 18:49:39,734 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=DataNode, sessionId=null - already initialized
2011-08-09 18:49:39,761 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:39,764 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=DataNode, port=35088
2011-08-09 18:49:39,765 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:39,767 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 35088: starting
2011-08-09 18:49:39,767 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 35088: starting
2011-08-09 18:49:39,767 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 35088: starting
2011-08-09 18:49:39,768 INFO  datanode.DataNode (DataNode.java:startDataNode(418)) - dnRegistration = DatanodeRegistration(m3vm6.tuenti.local:56645, storageID=, infoPort=45198, ipcPort=35088)
2011-08-09 18:49:39,770 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 35088: starting
2011-08-09 18:49:39,808 INFO  hdfs.StateChange (FSNamesystem.java:registerDatanode(2757)) - BLOCK* NameSystem.registerDatanode: node registration from 127.0.0.1:56645 storage DS-1952448891-10.0.62.238-56645-1312908579804
2011-08-09 18:49:39,812 INFO  net.NetworkTopology (NetworkTopology.java:add(328)) - Adding a new node: /default-rack/127.0.0.1:56645
2011-08-09 18:49:39,816 INFO  datanode.DataNode (DataNode.java:register(592)) - New storage id DS-1952448891-10.0.62.238-56645-1312908579804 is assigned to data-node 127.0.0.1:56645
2011-08-09 18:49:39,818 INFO  datanode.DataNode (DataNode.java:run(1274)) - DatanodeRegistration(127.0.0.1:56645, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=45198, ipcPort=35088)In DataNode.run, data = FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/datanodeMaster/current'}
2011-08-09 18:49:39,818 INFO  datanode.DataNode (DataNode.java:offerService(756)) - using BLOCKREPORT_INTERVAL of 3600000msec Initial delay: 0msec
2011-08-09 18:49:39,822 INFO  datanode.DataNode (FSDataset.java:getBlockInfo(601)) - Finished generating block report for 1 volumes in 0 seconds
2011-08-09 18:49:39,836 INFO  hdfs.StateChange (FSNamesystem.java:processReport(3701)) - BLOCK* NameSystem.processReport: from 127.0.0.1:56645 0 blocks shortCircuit first report.
2011-08-09 18:49:39,837 INFO  datanode.DataNode (DataNode.java:offerService(839)) - BlockReport of 0 blocks got processed in 15 msecs
2011-08-09 18:49:39,837 INFO  datanode.DataNode (DataNode.java:offerService(864)) - Starting Periodic block scanner.
2011-08-09 18:49:39,838 INFO  datanode.DataNode (FSDataset.java:getBlockInfo(601)) - Finished generating block report for 1 volumes in 0 seconds
2011-08-09 18:49:39,856 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditEvent(136)) - ugi=jeff,jeff	ip=/127.0.0.1	cmd=mkdirs	src=/TestUpgrade	dst=null	perm=jeff:supergroup:rwxr-xr-x
2011-08-09 18:49:39,868 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditEvent(136)) - ugi=jeff,jeff	ip=/127.0.0.1	cmd=create	src=/TestUpgrade/file1	dst=null	perm=jeff:supergroup:rw-r--r--
2011-08-09 18:49:39,878 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file1. blk_6325732594458780661_1001
2011-08-09 18:49:39,953 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_6325732594458780661_1001 src: /127.0.0.1:49480 dest: /127.0.0.1:56645
2011-08-09 18:49:40,010 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49480, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_6325732594458780661_1001, duration: 807861
2011-08-09 18:49:40,019 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_6325732594458780661_1001 size 1024
2011-08-09 18:49:40,022 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_6325732594458780661_1001 terminating
2011-08-09 18:49:40,022 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file1. blk_6287282349914631364_1001
2011-08-09 18:49:40,026 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_6287282349914631364_1001 src: /127.0.0.1:49481 dest: /127.0.0.1:56645
2011-08-09 18:49:40,028 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49481, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_6287282349914631364_1001, duration: 571734
2011-08-09 18:49:40,029 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_6287282349914631364_1001 terminating
2011-08-09 18:49:40,033 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_6287282349914631364_1001 size 1024
2011-08-09 18:49:40,035 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file1. blk_1946405918346137058_1001
2011-08-09 18:49:40,036 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_1946405918346137058_1001 src: /127.0.0.1:49482 dest: /127.0.0.1:56645
2011-08-09 18:49:40,038 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_1946405918346137058_1001 size 1024
2011-08-09 18:49:40,039 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49482, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_1946405918346137058_1001, duration: 246745
2011-08-09 18:49:40,039 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_1946405918346137058_1001 terminating
2011-08-09 18:49:40,040 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file1. blk_-795300428561515820_1001
2011-08-09 18:49:40,041 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_-795300428561515820_1001 src: /127.0.0.1:49483 dest: /127.0.0.1:56645
2011-08-09 18:49:40,043 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_-795300428561515820_1001 size 1024
2011-08-09 18:49:40,044 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49483, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_-795300428561515820_1001, duration: 444310
2011-08-09 18:49:40,044 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_-795300428561515820_1001 terminating
2011-08-09 18:49:40,045 INFO  hdfs.StateChange (FSNamesystem.java:completeFileInternal(1886)) - DIR* NameSystem.completeFile: file /TestUpgrade/file1 is closed by DFSClient_1809809385
2011-08-09 18:49:40,050 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditEvent(136)) - ugi=jeff,jeff	ip=/127.0.0.1	cmd=create	src=/TestUpgrade/file2	dst=null	perm=jeff:supergroup:rw-r--r--
2011-08-09 18:49:40,052 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file2. blk_-9180041566879651183_1002
2011-08-09 18:49:40,053 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_-9180041566879651183_1002 src: /127.0.0.1:49484 dest: /127.0.0.1:56645
2011-08-09 18:49:40,058 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49484, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_-9180041566879651183_1002, duration: 314929
2011-08-09 18:49:40,059 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_-9180041566879651183_1002 terminating
2011-08-09 18:49:40,059 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file2. blk_-9055752403876069634_1002
2011-08-09 18:49:40,060 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_-9180041566879651183_1002 size 1024
2011-08-09 18:49:40,061 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_-9055752403876069634_1002 src: /127.0.0.1:49485 dest: /127.0.0.1:56645
2011-08-09 18:49:40,074 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49485, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_-9055752403876069634_1002, duration: 357404
2011-08-09 18:49:40,075 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_-9055752403876069634_1002 size 1024
2011-08-09 18:49:40,075 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_-9055752403876069634_1002 terminating
2011-08-09 18:49:40,076 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file2. blk_-6140996453032080667_1002
2011-08-09 18:49:40,077 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_-6140996453032080667_1002 src: /127.0.0.1:49486 dest: /127.0.0.1:56645
2011-08-09 18:49:40,079 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49486, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_-6140996453032080667_1002, duration: 416087
2011-08-09 18:49:40,079 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_-6140996453032080667_1002 size 1024
2011-08-09 18:49:40,080 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_-6140996453032080667_1002 terminating
2011-08-09 18:49:40,081 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file2. blk_4966855053082251656_1002
2011-08-09 18:49:40,084 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_4966855053082251656_1002 src: /127.0.0.1:49487 dest: /127.0.0.1:56645
2011-08-09 18:49:40,086 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49487, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_4966855053082251656_1002, duration: 282235
2011-08-09 18:49:40,086 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_4966855053082251656_1002 terminating
2011-08-09 18:49:40,087 INFO  namenode.FSNamesystem (FSNamesystem.java:checkFileProgress(1947)) - INodeFile "file2":jeff:supergroup:rw-r--r-- block blk_4966855053082251656_1002 has replication 0 and requires 1
2011-08-09 18:49:40,088 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_4966855053082251656_1002 size 1024
2011-08-09 18:49:40,489 INFO  hdfs.StateChange (FSNamesystem.java:completeFileInternal(1886)) - DIR* NameSystem.completeFile: file /TestUpgrade/file2 is closed by DFSClient_1809809385
2011-08-09 18:49:40,491 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/namenodeMaster/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:40,579 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 7 Total time for transactions(ms): 1 Number of transactions batched in Syncs: 0 Number of syncs: 6 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/namenodeMaster/current/edits:10 
2011-08-09 18:49:40,582 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/namenodeMaster/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:40,610 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/namenodeMaster/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:40,615 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 501 saved in 0 seconds.
2011-08-09 18:49:40,620 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/namenodeMaster/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:40,630 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/namenodeMaster/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:40,636 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditEvent(136)) - ugi=jeff,jeff	ip=/127.0.0.1	cmd=create	src=/TestUpgrade/file3	dst=null	perm=jeff:supergroup:rw-r--r--
2011-08-09 18:49:40,638 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file3. blk_2780398403927012162_1003
2011-08-09 18:49:40,639 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_2780398403927012162_1003 src: /127.0.0.1:49488 dest: /127.0.0.1:56645
2011-08-09 18:49:40,642 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49488, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_2780398403927012162_1003, duration: 769858
2011-08-09 18:49:40,642 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_2780398403927012162_1003 terminating
2011-08-09 18:49:40,643 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_2780398403927012162_1003 size 1024
2011-08-09 18:49:40,644 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file3. blk_-4893775147700097834_1003
2011-08-09 18:49:40,646 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_-4893775147700097834_1003 src: /127.0.0.1:49489 dest: /127.0.0.1:56645
2011-08-09 18:49:40,648 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49489, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_-4893775147700097834_1003, duration: 552732
2011-08-09 18:49:40,648 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_-4893775147700097834_1003 terminating
2011-08-09 18:49:40,649 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_-4893775147700097834_1003 size 1024
2011-08-09 18:49:40,650 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file3. blk_5316258600427170643_1003
2011-08-09 18:49:40,651 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_5316258600427170643_1003 src: /127.0.0.1:49490 dest: /127.0.0.1:56645
2011-08-09 18:49:40,654 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49490, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_5316258600427170643_1003, duration: 673730
2011-08-09 18:49:40,654 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_5316258600427170643_1003 terminating
2011-08-09 18:49:40,654 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_5316258600427170643_1003 size 1024
2011-08-09 18:49:40,656 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file3. blk_-8345496296486925113_1003
2011-08-09 18:49:40,657 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_-8345496296486925113_1003 src: /127.0.0.1:49491 dest: /127.0.0.1:56645
2011-08-09 18:49:40,659 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49491, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_-8345496296486925113_1003, duration: 511655
2011-08-09 18:49:40,659 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_-8345496296486925113_1003 terminating
2011-08-09 18:49:40,661 INFO  namenode.FSNamesystem (FSNamesystem.java:checkFileProgress(1947)) - INodeFile "file3":jeff:supergroup:rw-r--r-- block blk_-8345496296486925113_1003 has replication 0 and requires 1
2011-08-09 18:49:40,662 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_-8345496296486925113_1003 size 1024
2011-08-09 18:49:41,064 INFO  hdfs.StateChange (FSNamesystem.java:completeFileInternal(1886)) - DIR* NameSystem.completeFile: file /TestUpgrade/file3 is closed by DFSClient_1809809385
2011-08-09 18:49:41,068 INFO  FSNamesystem.audit (FSNamesystem.java:logAuditEvent(136)) - ugi=jeff,jeff	ip=/127.0.0.1	cmd=create	src=/TestUpgrade/file4	dst=null	perm=jeff:supergroup:rw-r--r--
2011-08-09 18:49:41,070 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file4. blk_3112096067853649416_1004
2011-08-09 18:49:41,072 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_3112096067853649416_1004 src: /127.0.0.1:49492 dest: /127.0.0.1:56645
2011-08-09 18:49:41,105 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49492, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_3112096067853649416_1004, duration: 3114639
2011-08-09 18:49:41,105 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_3112096067853649416_1004 size 1024
2011-08-09 18:49:41,106 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_3112096067853649416_1004 terminating
2011-08-09 18:49:41,109 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file4. blk_7232126017253564510_1004
2011-08-09 18:49:41,110 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_7232126017253564510_1004 src: /127.0.0.1:49493 dest: /127.0.0.1:56645
2011-08-09 18:49:41,167 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_7232126017253564510_1004 size 1024
2011-08-09 18:49:41,167 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49493, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_7232126017253564510_1004, duration: 14171803
2011-08-09 18:49:41,168 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_7232126017253564510_1004 terminating
2011-08-09 18:49:41,170 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file4. blk_-2602444351230548514_1004
2011-08-09 18:49:41,171 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_-2602444351230548514_1004 src: /127.0.0.1:49494 dest: /127.0.0.1:56645
2011-08-09 18:49:41,176 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49494, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_-2602444351230548514_1004, duration: 979717
2011-08-09 18:49:41,176 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_-2602444351230548514_1004 size 1024
2011-08-09 18:49:41,177 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_-2602444351230548514_1004 terminating
2011-08-09 18:49:41,179 INFO  hdfs.StateChange (FSNamesystem.java:allocateBlock(1930)) - BLOCK* NameSystem.allocateBlock: /TestUpgrade/file4. blk_-562674272194023004_1004
2011-08-09 18:49:41,181 INFO  datanode.DataNode (DataXceiver.java:writeBlock(254)) - Receiving block blk_-562674272194023004_1004 src: /127.0.0.1:49495 dest: /127.0.0.1:56645
2011-08-09 18:49:41,232 INFO  DataNode.clienttrace (BlockReceiver.java:lastDataNodeRun(820)) - src: /127.0.0.1:49495, dest: /127.0.0.1:56645, bytes: 1024, op: HDFS_WRITE, cliID: DFSClient_1809809385, offset: 0, srvID: DS-1952448891-10.0.62.238-56645-1312908579804, blockid: blk_-562674272194023004_1004, duration: 1263349
2011-08-09 18:49:41,235 INFO  hdfs.StateChange (FSNamesystem.java:addStoredBlock(3893)) - BLOCK* NameSystem.addStoredBlock: blockMap updated: 127.0.0.1:56645 is added to blk_-562674272194023004_1004 size 1024
2011-08-09 18:49:41,236 INFO  datanode.DataNode (BlockReceiver.java:lastDataNodeRun(851)) - PacketResponder 0 for block blk_-562674272194023004_1004 terminating
2011-08-09 18:49:41,239 INFO  hdfs.StateChange (FSNamesystem.java:completeFileInternal(1886)) - DIR* NameSystem.completeFile: file /TestUpgrade/file4 is closed by DFSClient_1809809385
Shutting down the Mini HDFS Cluster
Shutting down DataNode 0
2011-08-09 18:49:41,274 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:41,375 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 35088
2011-08-09 18:49:41,375 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 35088: exiting
2011-08-09 18:49:41,375 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 35088: exiting
2011-08-09 18:49:41,376 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 35088
2011-08-09 18:49:41,376 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 35088: exiting
2011-08-09 18:49:41,377 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 1
2011-08-09 18:49:41,378 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:41,378 WARN  datanode.DataNode (DataXceiverServer.java:run(138)) - DatanodeRegistration(127.0.0.1:56645, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=45198, ipcPort=35088):DataXceiveServer: java.nio.channels.AsynchronousCloseException
	at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:152)
	at sun.nio.ch.ServerSocketAdaptor.accept(ServerSocketAdaptor.java:84)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiverServer.run(DataXceiverServer.java:131)
	at java.lang.Thread.run(Thread.java:662)

2011-08-09 18:49:41,847 INFO  datanode.DataBlockScanner (DataBlockScanner.java:run(604)) - Exiting DataBlockScanner thread.
2011-08-09 18:49:42,378 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 18:49:42,379 INFO  datanode.DataNode (DataNode.java:run(1294)) - DatanodeRegistration(127.0.0.1:56645, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=45198, ipcPort=35088):Finishing DataNode in: FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/datanodeMaster/current'}
2011-08-09 18:49:42,379 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 35088
2011-08-09 18:49:42,379 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 18:49:42,380 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(128)) - Shutting down all async disk service threads...
2011-08-09 18:49:42,380 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(137)) - All async disk service threads have been shut down.
2011-08-09 18:49:42,380 WARN  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(125)) - AsyncDiskService has already shut down.
2011-08-09 18:49:42,403 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:42,504 WARN  namenode.FSNamesystem (FSNamesystem.java:run(3042)) - ReplicationMonitor thread received InterruptedException.java.lang.InterruptedException: sleep interrupted
2011-08-09 18:49:42,505 INFO  namenode.DecommissionManager (DecommissionManager.java:waitForWork(254)) - Interrupted Monitor
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.waitForWork(DecommissionManager.java:244)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.run(DecommissionManager.java:267)
	at java.lang.Thread.run(Thread.java:662)
2011-08-09 18:49:42,506 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 6 Total time for transactions(ms): 1 Number of transactions batched in Syncs: 0 Number of syncs: 5 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/namenodeMaster/current/edits:7  /home/jeff/hadoop-20-warehouse/build/test/data/namenodeMaster/current/edits:1 
2011-08-09 18:49:42,537 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 42605
2011-08-09 18:49:42,537 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 42605: exiting
2011-08-09 18:49:42,537 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 42605: exiting
2011-08-09 18:49:42,537 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 42605: exiting
2011-08-09 18:49:42,538 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 3 on 42605: exiting
2011-08-09 18:49:42,538 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 4 on 42605: exiting
2011-08-09 18:49:42,538 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 5 on 42605: exiting
2011-08-09 18:49:42,538 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 6 on 42605: exiting
2011-08-09 18:49:42,539 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 7 on 42605: exiting
2011-08-09 18:49:42,539 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 8 on 42605: exiting
2011-08-09 18:49:42,539 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 9 on 42605: exiting
2011-08-09 18:49:42,540 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 42605
2011-08-09 18:49:42,541 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:42,603 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:42,604 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 0*** Normal NameNode rollback: numDirs=1
2011-08-09 18:49:42,750 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:42,792 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:42,793 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:42,793 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:42,794 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:42,794 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:42,883 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:42,887 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:42,889 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:42,891 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:42,895 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:42,895 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:42,896 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:42,900 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   new LV = -27; new CTime = 0
2011-08-09 18:49:42,900 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:42,901 INFO  common.Storage (FSImage.java:loadFSImage(1034)) - Number of files = 4
2011-08-09 18:49:42,902 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 25% of the image
2011-08-09 18:49:42,902 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 50% of the image
2011-08-09 18:49:42,904 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 75% of the image
2011-08-09 18:49:42,904 INFO  common.Storage (FSImage.java:loadFilesUnderConstruction(1499)) - Number of files under construction = 0
2011-08-09 18:49:42,905 INFO  common.Storage (FSImage.java:loadFSImage(1144)) - Image file of size 501 loaded in 0 seconds.
2011-08-09 18:49:42,909 INFO  common.Storage (FSEditLog.java:loadFSEdits(886)) - Edits file /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits of size 648 edits # 6 loaded in 0 seconds.
2011-08-09 18:49:42,910 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:42,945 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:42,955 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:42,955 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:42,959 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:42,969 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2011-08-09 18:49:42,969 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(372)) - Finished loading FSImage in 86 msecs
2011-08-09 18:49:42,978 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(5472)) - STATE* Safe mode ON. 
The ratio of reported blocks 0.00000000 has not reached the threshold 0.99900001. Safe blocks = 0, Total blocks = 16.Safe mode will be turned off automatically.
2011-08-09 18:49:42,978 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(388)) - Skip counting items in the file tree
2011-08-09 18:49:43,020 INFO  util.HostsFileReader (HostsFileReader.java:refresh(80)) - Refreshing hosts (include/exclude) list
2011-08-09 18:49:43,026 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:43,028 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=NameNode, port=34280
2011-08-09 18:49:43,029 INFO  namenode.NameNode (NameNode.java:startServerForClientRequests(396)) - Namenode up at: localhost/127.0.0.1:34280
2011-08-09 18:49:43,029 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:43,030 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 34280: starting
2011-08-09 18:49:43,030 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 34280: starting
2011-08-09 18:49:43,030 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 34280: starting
2011-08-09 18:49:43,031 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 34280: starting
2011-08-09 18:49:43,031 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 3 on 34280: starting
2011-08-09 18:49:43,031 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 4 on 34280: starting
2011-08-09 18:49:43,032 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 5 on 34280: starting
2011-08-09 18:49:43,032 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 6 on 34280: starting
2011-08-09 18:49:43,032 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 7 on 34280: starting
2011-08-09 18:49:43,033 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 8 on 34280: starting
2011-08-09 18:49:43,033 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 9 on 34280: starting
2011-08-09 18:49:43,057 WARN  fs.Trash (Trash.java:<init>(232)) - The configured interval for checkpoint is 0 minutes. Using interval of 0 minutes that is used for deletion instead
2011-08-09 18:49:43,067 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:43,068 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:43,069 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 34147 webServer.getConnectors()[0].getLocalPort() returned 34147
2011-08-09 18:49:43,069 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 34147
2011-08-09 18:49:43,070 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:43,229 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:34147
2011-08-09 18:49:43,230 INFO  namenode.NameNode (NameNode.java:startHttpServer(329)) - Web-server up at: localhost:34147
Shutting down the Mini HDFS Cluster
2011-08-09 18:49:43,232 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:43,334 WARN  namenode.FSNamesystem (FSNamesystem.java:run(3042)) - ReplicationMonitor thread received InterruptedException.java.lang.InterruptedException: sleep interrupted
2011-08-09 18:49:43,334 INFO  namenode.DecommissionManager (DecommissionManager.java:waitForWork(254)) - Interrupted Monitor
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.waitForWork(DecommissionManager.java:244)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.run(DecommissionManager.java:267)
	at java.lang.Thread.run(Thread.java:662)
2011-08-09 18:49:43,335 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 0 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 0 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits:0 
2011-08-09 18:49:43,339 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 34280
2011-08-09 18:49:43,339 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 34280: exiting
2011-08-09 18:49:43,341 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 9 on 34280: exiting
2011-08-09 18:49:43,340 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 5 on 34280: exiting
2011-08-09 18:49:43,341 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 7 on 34280: exiting
2011-08-09 18:49:43,341 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 4 on 34280: exiting
2011-08-09 18:49:43,340 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 34280
2011-08-09 18:49:43,340 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 34280: exiting
2011-08-09 18:49:43,340 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 34280: exiting
2011-08-09 18:49:43,340 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 3 on 34280: exiting
2011-08-09 18:49:43,343 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 6 on 34280: exiting
2011-08-09 18:49:43,343 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 8 on 34280: exiting
2011-08-09 18:49:43,343 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:43,342 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:43,345 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 1*** Normal DataNode rollback: numDirs=1
2011-08-09 18:49:43,418 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:43,421 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:43,421 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:43,422 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:43,422 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:43,422 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:43,429 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:43,430 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:43,432 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:43,432 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:43,436 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:43,437 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:43,437 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:43,440 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   new LV = -27; new CTime = 0
2011-08-09 18:49:43,441 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:43,442 INFO  common.Storage (FSImage.java:loadFSImage(1034)) - Number of files = 4
2011-08-09 18:49:43,442 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 25% of the image
2011-08-09 18:49:43,442 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 50% of the image
2011-08-09 18:49:43,443 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 75% of the image
2011-08-09 18:49:43,443 INFO  common.Storage (FSImage.java:loadFilesUnderConstruction(1499)) - Number of files under construction = 0
2011-08-09 18:49:43,443 INFO  common.Storage (FSImage.java:loadFSImage(1144)) - Image file of size 501 loaded in 0 seconds.
2011-08-09 18:49:43,445 INFO  common.Storage (FSEditLog.java:loadFSEdits(886)) - Edits file /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits of size 648 edits # 6 loaded in 0 seconds.
2011-08-09 18:49:43,445 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:43,472 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:43,477 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:43,487 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:43,488 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:43,498 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2011-08-09 18:49:43,498 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(372)) - Finished loading FSImage in 69 msecs
2011-08-09 18:49:43,499 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(5472)) - STATE* Safe mode ON. 
The ratio of reported blocks 0.00000000 has not reached the threshold 0.99900001. Safe blocks = 0, Total blocks = 16.Safe mode will be turned off automatically.
2011-08-09 18:49:43,499 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(388)) - Skip counting items in the file tree
2011-08-09 18:49:43,500 INFO  util.HostsFileReader (HostsFileReader.java:refresh(80)) - Refreshing hosts (include/exclude) list
2011-08-09 18:49:43,502 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:43,505 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=NameNode, port=50005
2011-08-09 18:49:43,505 INFO  namenode.NameNode (NameNode.java:startServerForClientRequests(396)) - Namenode up at: localhost/127.0.0.1:50005
2011-08-09 18:49:43,506 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:43,506 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 50005: starting
2011-08-09 18:49:43,507 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 50005: starting
2011-08-09 18:49:43,507 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 50005: starting
2011-08-09 18:49:43,507 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 50005: starting
2011-08-09 18:49:43,508 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 3 on 50005: starting
2011-08-09 18:49:43,508 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 5 on 50005: starting
2011-08-09 18:49:43,508 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 6 on 50005: starting
2011-08-09 18:49:43,508 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 4 on 50005: starting
2011-08-09 18:49:43,509 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 7 on 50005: starting
2011-08-09 18:49:43,509 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 8 on 50005: starting
2011-08-09 18:49:43,509 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 9 on 50005: starting
2011-08-09 18:49:43,531 WARN  fs.Trash (Trash.java:<init>(232)) - The configured interval for checkpoint is 0 minutes. Using interval of 0 minutes that is used for deletion instead
2011-08-09 18:49:43,579 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:43,581 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:43,581 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 60565 webServer.getConnectors()[0].getLocalPort() returned 60565
2011-08-09 18:49:43,581 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 60565
2011-08-09 18:49:43,581 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:43,711 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:60565
2011-08-09 18:49:43,712 INFO  namenode.NameNode (NameNode.java:startHttpServer(329)) - Web-server up at: localhost:60565
Starting DataNode 0 with dfs.data.dir: /home/jeff/hadoop-20-warehouse/build/test/data/data1
2011-08-09 18:49:44,074 INFO  common.Storage (DataStorage.java:run(409)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/data1.
   target LV = -27; target CTime = 0
2011-08-09 18:49:44,076 INFO  common.Storage (DataStorage.java:run(422)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/data1 is complete.
2011-08-09 18:49:44,149 INFO  datanode.DataNode (FSDataset.java:registerMBean(1597)) - Registered FSDatasetStatusMBean
2011-08-09 18:49:44,150 INFO  datanode.DataNode (DataNode.java:startDataNode(327)) - Opened info server at 52199
2011-08-09 18:49:44,151 INFO  datanode.DataNode (DataXceiverServer.java:<init>(75)) - Balancing bandwith is 1048576 bytes/s
2011-08-09 18:49:44,151 INFO  datanode.DataNode (DataNode.java:startDataNode(359)) - Periodic Block Verification is disabled because verification is turned off by configuration.
2011-08-09 18:49:44,154 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:44,155 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:44,155 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 56435 webServer.getConnectors()[0].getLocalPort() returned 56435
2011-08-09 18:49:44,155 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 56435
2011-08-09 18:49:44,156 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:44,274 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:56435
2011-08-09 18:49:44,275 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=DataNode, sessionId=null - already initialized
2011-08-09 18:49:44,279 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:44,282 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=DataNode, port=45602
2011-08-09 18:49:44,283 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:44,284 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 45602: starting
2011-08-09 18:49:44,284 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 45602: starting
2011-08-09 18:49:44,327 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 45602: starting
2011-08-09 18:49:44,327 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 45602: starting
2011-08-09 18:49:44,327 INFO  datanode.DataNode (DataNode.java:startDataNode(418)) - dnRegistration = DatanodeRegistration(m3vm6.tuenti.local:52199, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=56435, ipcPort=45602)
2011-08-09 18:49:44,330 INFO  hdfs.StateChange (FSNamesystem.java:registerDatanode(2757)) - BLOCK* NameSystem.registerDatanode: node registration from 127.0.0.1:52199 storage DS-1952448891-10.0.62.238-56645-1312908579804
2011-08-09 18:49:44,331 INFO  net.NetworkTopology (NetworkTopology.java:add(328)) - Adding a new node: /default-rack/127.0.0.1:52199
2011-08-09 18:49:44,332 INFO  datanode.DataNode (DataNode.java:run(1274)) - DatanodeRegistration(127.0.0.1:52199, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=56435, ipcPort=45602)In DataNode.run, data = FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/data1/current'}
2011-08-09 18:49:44,334 INFO  datanode.DataNode (DataNode.java:offerService(756)) - using BLOCKREPORT_INTERVAL of 10000msec Initial delay: 0msec
Shutting down the Mini HDFS Cluster
Shutting down DataNode 0
2011-08-09 18:49:44,356 INFO  datanode.DataNode (FSDataset.java:getBlockInfo(601)) - Finished generating block report for 1 volumes in 0 seconds
2011-08-09 18:49:44,363 INFO  hdfs.StateChange (FSNamesystem.java:processReport(3701)) - BLOCK* NameSystem.processReport: from 127.0.0.1:52199 16 blocks shortCircuit first report.
2011-08-09 18:49:44,364 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(5294)) - initializing replication queues
2011-08-09 18:49:44,369 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4047)) - Total number of blocks = 16
2011-08-09 18:49:44,370 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4048)) - Number of invalid blocks = 0
2011-08-09 18:49:44,370 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4049)) - Number of under-replicated blocks = 1
2011-08-09 18:49:44,370 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4050)) - Number of  over-replicated blocks = 0
2011-08-09 18:49:44,428 INFO  hdfs.StateChange (FSNamesystem.java:leave(5269)) - STATE* Leaving safe mode after 0 secs.
2011-08-09 18:49:44,449 INFO  hdfs.StateChange (FSNamesystem.java:leave(5274)) - STATE* Safe mode is OFF.
2011-08-09 18:49:44,450 INFO  hdfs.StateChange (FSNamesystem.java:leave(5283)) - STATE* Network topology has 1 racks and 1 datanodes
2011-08-09 18:49:44,450 INFO  hdfs.StateChange (FSNamesystem.java:leave(5286)) - STATE* UnderReplicatedBlocks has 1 blocks
2011-08-09 18:49:44,451 INFO  datanode.DataNode (DataNode.java:offerService(839)) - BlockReport of 16 blocks got processed in 106 msecs
2011-08-09 18:49:44,461 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:44,562 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 45602
2011-08-09 18:49:44,562 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 45602: exiting
2011-08-09 18:49:44,562 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 45602
2011-08-09 18:49:44,563 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 45602: exiting
2011-08-09 18:49:44,563 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 45602: exiting
2011-08-09 18:49:44,565 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:44,565 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 1
2011-08-09 18:49:44,566 WARN  datanode.DataNode (DataXceiverServer.java:run(138)) - DatanodeRegistration(127.0.0.1:52199, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=56435, ipcPort=45602):DataXceiveServer: java.nio.channels.AsynchronousCloseException
	at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:152)
	at sun.nio.ch.ServerSocketAdaptor.accept(ServerSocketAdaptor.java:84)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiverServer.run(DataXceiverServer.java:131)
	at java.lang.Thread.run(Thread.java:662)

2011-08-09 18:49:45,566 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 18:49:45,566 INFO  datanode.DataNode (DataNode.java:run(1294)) - DatanodeRegistration(127.0.0.1:52199, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=56435, ipcPort=45602):Finishing DataNode in: FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/data1/current'}
2011-08-09 18:49:45,568 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 45602
2011-08-09 18:49:45,568 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 18:49:45,569 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(128)) - Shutting down all async disk service threads...
2011-08-09 18:49:45,569 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(137)) - All async disk service threads have been shut down.
2011-08-09 18:49:45,570 WARN  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(125)) - AsyncDiskService has already shut down.
2011-08-09 18:49:45,583 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:45,684 WARN  namenode.FSNamesystem (FSNamesystem.java:run(3042)) - ReplicationMonitor thread received InterruptedException.java.lang.InterruptedException: sleep interrupted
2011-08-09 18:49:45,684 INFO  namenode.DecommissionManager (DecommissionManager.java:waitForWork(254)) - Interrupted Monitor
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.waitForWork(DecommissionManager.java:244)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.run(DecommissionManager.java:267)
	at java.lang.Thread.run(Thread.java:662)
2011-08-09 18:49:45,685 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 0 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 0 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits:0 
2011-08-09 18:49:45,689 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 50005
2011-08-09 18:49:45,689 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 50005: exiting
2011-08-09 18:49:45,690 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 50005: exiting
2011-08-09 18:49:45,690 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 50005: exiting
2011-08-09 18:49:45,690 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 3 on 50005: exiting
2011-08-09 18:49:45,690 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 4 on 50005: exiting
2011-08-09 18:49:45,690 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 5 on 50005: exiting
2011-08-09 18:49:45,691 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 6 on 50005: exiting
2011-08-09 18:49:45,691 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 7 on 50005: exiting
2011-08-09 18:49:45,692 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 8 on 50005: exiting
2011-08-09 18:49:45,693 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 9 on 50005: exiting
2011-08-09 18:49:45,693 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 50005
2011-08-09 18:49:45,695 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:45,697 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:45,697 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 2*** NameNode rollback without existing previous dir: numDirs=1
2011-08-09 18:49:45,724 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:45,727 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:45,727 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:45,728 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:45,728 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:45,728 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:45,735 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:45,735 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:45,735 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:45,735 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:45,739 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:45,739 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:45,740 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:45,743 INFO  common.Storage (FSImage.java:doRollback(532)) - Storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1 does not contain previous fs state.
2011-08-09 18:49:45,743 ERROR namenode.FSNamesystem (FSNamesystem.java:<init>(347)) - FSNamesystem initialization failed.
java.io.IOException: Cannot rollback. None of the storage directories contain previous fs state.
	at org.apache.hadoop.hdfs.server.namenode.FSImage.doRollback(FSImage.java:542)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:452)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.loadFSImage(FSDirectory.java:151)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.initialize(FSNamesystem.java:369)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:345)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:273)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.<init>(NameNode.java:357)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1246)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:342)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:260)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:101)
	at org.apache.hadoop.hdfs.TestDFSRollback.startNameNodeShouldFail(TestDFSRollback.java:94)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:152)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
2011-08-09 18:49:45,744 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:45,745 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 3*** DataNode rollback without existing previous dir: numDirs=1
2011-08-09 18:49:45,801 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:45,831 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:45,831 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:45,832 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:45,832 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:45,832 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:45,837 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:45,838 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:45,838 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:45,838 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:45,841 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:45,842 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:45,842 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:45,846 INFO  common.Storage (FSImage.java:loadFSImage(1034)) - Number of files = 4
2011-08-09 18:49:45,846 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 25% of the image
2011-08-09 18:49:45,847 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 50% of the image
2011-08-09 18:49:45,847 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 75% of the image
2011-08-09 18:49:45,847 INFO  common.Storage (FSImage.java:loadFilesUnderConstruction(1499)) - Number of files under construction = 0
2011-08-09 18:49:45,848 INFO  common.Storage (FSImage.java:loadFSImage(1144)) - Image file of size 501 loaded in 0 seconds.
2011-08-09 18:49:45,849 INFO  common.Storage (FSEditLog.java:loadFSEdits(886)) - Edits file /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits of size 648 edits # 6 loaded in 0 seconds.
2011-08-09 18:49:45,850 INFO  common.Storage (FSImage.java:doUpgrade(491)) - Upgrading image directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   old LV = -27; old CTime = 0.
   new LV = -27; new CTime = 1312908585850
2011-08-09 18:49:45,856 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:45,856 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:46,014 INFO  common.Storage (FSImage.java:doUpgrade(514)) - Upgrade of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:46,015 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:46,016 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2011-08-09 18:49:46,016 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(372)) - Finished loading FSImage in 179 msecs
2011-08-09 18:49:46,016 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(5472)) - STATE* Safe mode ON. 
The ratio of reported blocks 0.00000000 has not reached the threshold 0.99900001. Safe blocks = 0, Total blocks = 16.Safe mode will be turned off automatically.
2011-08-09 18:49:46,016 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(388)) - Skip counting items in the file tree
2011-08-09 18:49:46,017 INFO  util.HostsFileReader (HostsFileReader.java:refresh(80)) - Refreshing hosts (include/exclude) list
2011-08-09 18:49:46,020 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:46,022 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=NameNode, port=36757
2011-08-09 18:49:46,022 INFO  namenode.NameNode (NameNode.java:startServerForClientRequests(396)) - Namenode up at: localhost/127.0.0.1:36757
2011-08-09 18:49:46,023 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:46,023 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 36757: starting
2011-08-09 18:49:46,024 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 36757: starting
2011-08-09 18:49:46,024 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 36757: starting
2011-08-09 18:49:46,024 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 3 on 36757: starting
2011-08-09 18:49:46,025 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 4 on 36757: starting
2011-08-09 18:49:46,025 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 5 on 36757: starting
2011-08-09 18:49:46,025 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 6 on 36757: starting
2011-08-09 18:49:46,025 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 7 on 36757: starting
2011-08-09 18:49:46,026 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 36757: starting
2011-08-09 18:49:46,026 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 8 on 36757: starting
2011-08-09 18:49:46,069 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 9 on 36757: starting
2011-08-09 18:49:46,079 WARN  fs.Trash (Trash.java:<init>(232)) - The configured interval for checkpoint is 0 minutes. Using interval of 0 minutes that is used for deletion instead
2011-08-09 18:49:46,081 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:46,082 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:46,083 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 35794 webServer.getConnectors()[0].getLocalPort() returned 35794
2011-08-09 18:49:46,083 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 35794
2011-08-09 18:49:46,083 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:46,221 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:35794
2011-08-09 18:49:46,228 INFO  namenode.NameNode (NameNode.java:startHttpServer(329)) - Web-server up at: localhost:35794
Starting DataNode 0 with dfs.data.dir: /home/jeff/hadoop-20-warehouse/build/test/data/data1
2011-08-09 18:49:46,347 INFO  common.Storage (DataStorage.java:run(279)) - Upgrading storage directory /home/jeff/hadoop-20-warehouse/build/test/data/data1.
   old LV = -27; old CTime = 0.
   new LV = -27; new CTime = 1312908585850
2011-08-09 18:49:46,429 INFO  common.Storage (DataStorage.java:run(297)) - Completed upgrading storage directory /home/jeff/hadoop-20-warehouse/build/test/data/data1HardLinkStats: 1 Directories, including 0 Empty Directories, 0 single Link operations, 1 multi-Link operations, linking 32 files, total 32 linkable files.  Also physically copied 1 other files.
2011-08-09 18:49:46,454 INFO  common.Storage (DataStorage.java:doUpgrade(348)) - Upgrade of /home/jeff/hadoop-20-warehouse/build/test/data/data1 is complete.
2011-08-09 18:49:46,571 INFO  datanode.DataNode (FSDataset.java:registerMBean(1597)) - Registered FSDatasetStatusMBean
2011-08-09 18:49:46,572 INFO  datanode.DataNode (DataNode.java:startDataNode(327)) - Opened info server at 41463
2011-08-09 18:49:46,573 INFO  datanode.DataNode (DataXceiverServer.java:<init>(75)) - Balancing bandwith is 1048576 bytes/s
2011-08-09 18:49:46,573 INFO  datanode.DataNode (DataNode.java:startDataNode(359)) - Periodic Block Verification is disabled because verification is turned off by configuration.
2011-08-09 18:49:46,576 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:46,577 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:46,577 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 50098 webServer.getConnectors()[0].getLocalPort() returned 50098
2011-08-09 18:49:46,577 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 50098
2011-08-09 18:49:46,578 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:46,649 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:50098
2011-08-09 18:49:46,649 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=DataNode, sessionId=null - already initialized
2011-08-09 18:49:46,654 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:46,656 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=DataNode, port=53086
2011-08-09 18:49:46,658 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:46,681 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 53086: starting
2011-08-09 18:49:46,682 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 53086: starting
2011-08-09 18:49:46,682 INFO  datanode.DataNode (DataNode.java:startDataNode(418)) - dnRegistration = DatanodeRegistration(m3vm6.tuenti.local:41463, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=50098, ipcPort=53086)
2011-08-09 18:49:46,682 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 53086: starting
2011-08-09 18:49:46,692 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 53086: starting
2011-08-09 18:49:46,696 INFO  hdfs.StateChange (FSNamesystem.java:registerDatanode(2757)) - BLOCK* NameSystem.registerDatanode: node registration from 127.0.0.1:41463 storage DS-1952448891-10.0.62.238-56645-1312908579804
2011-08-09 18:49:46,697 INFO  net.NetworkTopology (NetworkTopology.java:add(328)) - Adding a new node: /default-rack/127.0.0.1:41463
2011-08-09 18:49:46,698 INFO  datanode.DataNode (DataNode.java:run(1274)) - DatanodeRegistration(127.0.0.1:41463, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=50098, ipcPort=53086)In DataNode.run, data = FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/data1/current'}
2011-08-09 18:49:46,699 INFO  datanode.DataNode (DataNode.java:offerService(756)) - using BLOCKREPORT_INTERVAL of 10000msec Initial delay: 0msec
2011-08-09 18:49:46,706 INFO  datanode.DataNode (FSDataset.java:getBlockInfo(601)) - Finished generating block report for 1 volumes in 0 seconds
2011-08-09 18:49:46,707 INFO  hdfs.StateChange (FSNamesystem.java:processReport(3701)) - BLOCK* NameSystem.processReport: from 127.0.0.1:41463 16 blocks shortCircuit first report.
2011-08-09 18:49:46,708 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(5294)) - initializing replication queues
2011-08-09 18:49:46,712 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4047)) - Total number of blocks = 16
2011-08-09 18:49:46,713 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4048)) - Number of invalid blocks = 0
2011-08-09 18:49:46,713 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4049)) - Number of under-replicated blocks = 1
2011-08-09 18:49:46,713 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4050)) - Number of  over-replicated blocks = 0
2011-08-09 18:49:46,714 INFO  hdfs.StateChange (FSNamesystem.java:leave(5269)) - STATE* Leaving safe mode after 0 secs.
2011-08-09 18:49:46,715 INFO  hdfs.StateChange (FSNamesystem.java:leave(5274)) - STATE* Safe mode is OFF.
2011-08-09 18:49:46,715 INFO  hdfs.StateChange (FSNamesystem.java:leave(5283)) - STATE* Network topology has 1 racks and 1 datanodes
2011-08-09 18:49:46,715 INFO  hdfs.StateChange (FSNamesystem.java:leave(5286)) - STATE* UnderReplicatedBlocks has 1 blocks
2011-08-09 18:49:46,722 INFO  datanode.DataNode (DataNode.java:offerService(839)) - BlockReport of 16 blocks got processed in 18 msecs
Shutting down the Mini HDFS Cluster
Shutting down DataNode 0
2011-08-09 18:49:46,779 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:46,780 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 53086
2011-08-09 18:49:46,780 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 53086
2011-08-09 18:49:46,781 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:46,781 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 1
2011-08-09 18:49:46,782 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 53086: exiting
2011-08-09 18:49:46,783 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 53086: exiting
2011-08-09 18:49:46,783 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 53086: exiting
2011-08-09 18:49:46,783 WARN  datanode.DataNode (DataXceiverServer.java:run(138)) - DatanodeRegistration(127.0.0.1:41463, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=50098, ipcPort=53086):DataXceiveServer: java.nio.channels.AsynchronousCloseException
	at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:152)
	at sun.nio.ch.ServerSocketAdaptor.accept(ServerSocketAdaptor.java:84)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiverServer.run(DataXceiverServer.java:131)
	at java.lang.Thread.run(Thread.java:662)

2011-08-09 18:49:47,782 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 18:49:47,783 INFO  datanode.DataNode (DataNode.java:run(1294)) - DatanodeRegistration(127.0.0.1:41463, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=50098, ipcPort=53086):Finishing DataNode in: FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/data1/current'}
2011-08-09 18:49:47,785 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 53086
2011-08-09 18:49:47,785 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 18:49:47,786 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(128)) - Shutting down all async disk service threads...
2011-08-09 18:49:47,786 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(137)) - All async disk service threads have been shut down.
2011-08-09 18:49:47,787 WARN  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(125)) - AsyncDiskService has already shut down.
2011-08-09 18:49:47,825 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:47,927 WARN  namenode.FSNamesystem (FSNamesystem.java:run(3042)) - ReplicationMonitor thread received InterruptedException.java.lang.InterruptedException: sleep interrupted
2011-08-09 18:49:47,928 INFO  namenode.DecommissionManager (DecommissionManager.java:waitForWork(254)) - Interrupted Monitor
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.waitForWork(DecommissionManager.java:244)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.run(DecommissionManager.java:267)
	at java.lang.Thread.run(Thread.java:662)
2011-08-09 18:49:47,929 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 0 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 0 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits:0 
2011-08-09 18:49:47,932 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 36757
2011-08-09 18:49:47,932 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 36757: exiting
2011-08-09 18:49:47,933 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 36757: exiting
2011-08-09 18:49:47,933 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 36757: exiting
2011-08-09 18:49:47,933 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 3 on 36757: exiting
2011-08-09 18:49:47,934 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 4 on 36757: exiting
2011-08-09 18:49:47,934 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 5 on 36757: exiting
2011-08-09 18:49:47,934 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 8 on 36757: exiting
2011-08-09 18:49:47,934 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 6 on 36757: exiting
2011-08-09 18:49:47,935 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 9 on 36757: exiting
2011-08-09 18:49:47,935 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 36757
2011-08-09 18:49:47,935 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 7 on 36757: exiting
2011-08-09 18:49:47,936 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:47,940 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:47,940 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 4*** DataNode rollback with future stored layout version in previous: numDirs=1
2011-08-09 18:49:47,974 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:47,977 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:47,978 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:47,978 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:47,978 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:47,978 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:47,985 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:47,985 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:47,985 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:47,985 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:47,989 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:47,989 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:47,990 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:47,994 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   new LV = -27; new CTime = 0
2011-08-09 18:49:47,994 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:47,995 INFO  common.Storage (FSImage.java:loadFSImage(1034)) - Number of files = 4
2011-08-09 18:49:47,995 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 25% of the image
2011-08-09 18:49:47,995 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 50% of the image
2011-08-09 18:49:47,996 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 75% of the image
2011-08-09 18:49:47,996 INFO  common.Storage (FSImage.java:loadFilesUnderConstruction(1499)) - Number of files under construction = 0
2011-08-09 18:49:47,996 INFO  common.Storage (FSImage.java:loadFSImage(1144)) - Image file of size 501 loaded in 0 seconds.
2011-08-09 18:49:47,997 INFO  common.Storage (FSEditLog.java:loadFSEdits(886)) - Edits file /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits of size 648 edits # 6 loaded in 0 seconds.
2011-08-09 18:49:47,998 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:48,026 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:48,030 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:48,032 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:48,035 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:48,045 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2011-08-09 18:49:48,045 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(372)) - Finished loading FSImage in 60 msecs
2011-08-09 18:49:48,045 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(5472)) - STATE* Safe mode ON. 
The ratio of reported blocks 0.00000000 has not reached the threshold 0.99900001. Safe blocks = 0, Total blocks = 16.Safe mode will be turned off automatically.
2011-08-09 18:49:48,046 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(388)) - Skip counting items in the file tree
2011-08-09 18:49:48,062 INFO  util.HostsFileReader (HostsFileReader.java:refresh(80)) - Refreshing hosts (include/exclude) list
2011-08-09 18:49:48,063 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:48,065 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=NameNode, port=43217
2011-08-09 18:49:48,066 INFO  namenode.NameNode (NameNode.java:startServerForClientRequests(396)) - Namenode up at: localhost/127.0.0.1:43217
2011-08-09 18:49:48,066 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:48,066 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 43217: starting
2011-08-09 18:49:48,067 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 43217: starting
2011-08-09 18:49:48,067 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 43217: starting
2011-08-09 18:49:48,068 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 3 on 43217: starting
2011-08-09 18:49:48,068 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 4 on 43217: starting
2011-08-09 18:49:48,068 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 5 on 43217: starting
2011-08-09 18:49:48,068 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 6 on 43217: starting
2011-08-09 18:49:48,068 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 7 on 43217: starting
2011-08-09 18:49:48,069 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 8 on 43217: starting
2011-08-09 18:49:48,069 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 9 on 43217: starting
2011-08-09 18:49:48,070 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 43217: starting
2011-08-09 18:49:48,111 WARN  fs.Trash (Trash.java:<init>(232)) - The configured interval for checkpoint is 0 minutes. Using interval of 0 minutes that is used for deletion instead
2011-08-09 18:49:48,116 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:48,117 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:48,118 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 37881 webServer.getConnectors()[0].getLocalPort() returned 37881
2011-08-09 18:49:48,118 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 37881
2011-08-09 18:49:48,118 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:48,169 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:37881
2011-08-09 18:49:48,170 INFO  namenode.NameNode (NameNode.java:startHttpServer(329)) - Web-server up at: localhost:37881
Starting DataNode 0 with dfs.data.dir: /home/jeff/hadoop-20-warehouse/build/test/data/data1
2011-08-09 18:49:48,478 INFO  datanode.DataNode (DataNode.java:<init>(227)) - Failed to start datanode java.io.IOException: org.apache.hadoop.hdfs.server.common.IncorrectVersionException: Unexpected version of storage directory /home/jeff/hadoop-20-warehouse/build/test/data/data1. Reported: -2147483648. Expecting = -27.
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.doRollback(DataStorage.java:373)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.doTransition(DataStorage.java:220)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.recoverTransitionRead(DataStorage.java:148)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.startDataNode(DataNode.java:308)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.<init>(DataNode.java:225)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.makeInstance(DataNode.java:1379)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.instantiateDataNode(DataNode.java:1334)
	at org.apache.hadoop.hdfs.MiniDFSCluster.startDataNodes(MiniDFSCluster.java:485)
	at org.apache.hadoop.hdfs.MiniDFSCluster.startDataNodes(MiniDFSCluster.java:526)
	at org.apache.hadoop.hdfs.TestDFSRollback.startDataNodeShouldFail(TestDFSRollback.java:107)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:174)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
Caused by: org.apache.hadoop.hdfs.server.common.IncorrectVersionException: Unexpected version of storage directory /home/jeff/hadoop-20-warehouse/build/test/data/data1. Reported: -2147483648. Expecting = -27.
	at org.apache.hadoop.hdfs.server.common.Storage.getFields(Storage.java:662)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.getFields(DataStorage.java:173)
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.read(Storage.java:238)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage$RollbackThread.run(DataStorage.java:398)

Shutting down the Mini HDFS Cluster
2011-08-09 18:49:48,481 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:48,482 WARN  namenode.FSNamesystem (FSNamesystem.java:run(3042)) - ReplicationMonitor thread received InterruptedException.java.lang.InterruptedException: sleep interrupted
2011-08-09 18:49:48,482 INFO  namenode.DecommissionManager (DecommissionManager.java:waitForWork(254)) - Interrupted Monitor
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.waitForWork(DecommissionManager.java:244)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.run(DecommissionManager.java:267)
	at java.lang.Thread.run(Thread.java:662)
2011-08-09 18:49:48,483 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 0 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 0 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits:0 
2011-08-09 18:49:48,487 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 43217
2011-08-09 18:49:48,487 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 43217: exiting
2011-08-09 18:49:48,487 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 43217: exiting
2011-08-09 18:49:48,488 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 3 on 43217: exiting
2011-08-09 18:49:48,488 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 4 on 43217: exiting
2011-08-09 18:49:48,488 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 43217: exiting
2011-08-09 18:49:48,505 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 5 on 43217: exiting
2011-08-09 18:49:48,505 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 7 on 43217: exiting
2011-08-09 18:49:48,505 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 6 on 43217: exiting
2011-08-09 18:49:48,506 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 8 on 43217: exiting
2011-08-09 18:49:48,506 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 43217
2011-08-09 18:49:48,506 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 9 on 43217: exiting
2011-08-09 18:49:48,508 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:48,512 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:48,512 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 5*** DataNode rollback with newer fsscTime in previous: numDirs=1
2011-08-09 18:49:48,576 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:48,579 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:48,579 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:48,579 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:48,579 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:48,579 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:48,585 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:48,585 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:48,586 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:48,586 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:48,589 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:48,589 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:48,590 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:48,592 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   new LV = -27; new CTime = 0
2011-08-09 18:49:48,593 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:48,593 INFO  common.Storage (FSImage.java:loadFSImage(1034)) - Number of files = 4
2011-08-09 18:49:48,594 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 25% of the image
2011-08-09 18:49:48,594 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 50% of the image
2011-08-09 18:49:48,594 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 75% of the image
2011-08-09 18:49:48,595 INFO  common.Storage (FSImage.java:loadFilesUnderConstruction(1499)) - Number of files under construction = 0
2011-08-09 18:49:48,595 INFO  common.Storage (FSImage.java:loadFSImage(1144)) - Image file of size 501 loaded in 0 seconds.
2011-08-09 18:49:48,596 INFO  common.Storage (FSEditLog.java:loadFSEdits(886)) - Edits file /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits of size 648 edits # 6 loaded in 0 seconds.
2011-08-09 18:49:48,596 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:48,757 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:48,765 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:48,766 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:48,772 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:48,781 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2011-08-09 18:49:48,781 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(372)) - Finished loading FSImage in 196 msecs
2011-08-09 18:49:48,782 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(5472)) - STATE* Safe mode ON. 
The ratio of reported blocks 0.00000000 has not reached the threshold 0.99900001. Safe blocks = 0, Total blocks = 16.Safe mode will be turned off automatically.
2011-08-09 18:49:48,782 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(388)) - Skip counting items in the file tree
2011-08-09 18:49:48,822 INFO  util.HostsFileReader (HostsFileReader.java:refresh(80)) - Refreshing hosts (include/exclude) list
2011-08-09 18:49:48,824 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:48,826 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=NameNode, port=52835
2011-08-09 18:49:48,827 INFO  namenode.NameNode (NameNode.java:startServerForClientRequests(396)) - Namenode up at: localhost/127.0.0.1:52835
2011-08-09 18:49:48,827 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:48,827 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 52835: starting
2011-08-09 18:49:48,850 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 52835: starting
2011-08-09 18:49:48,850 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 52835: starting
2011-08-09 18:49:48,850 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 3 on 52835: starting
2011-08-09 18:49:48,851 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 4 on 52835: starting
2011-08-09 18:49:48,851 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 5 on 52835: starting
2011-08-09 18:49:48,851 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 6 on 52835: starting
2011-08-09 18:49:48,851 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 7 on 52835: starting
2011-08-09 18:49:48,852 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 8 on 52835: starting
2011-08-09 18:49:48,852 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 9 on 52835: starting
2011-08-09 18:49:48,852 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 52835: starting
2011-08-09 18:49:48,860 WARN  fs.Trash (Trash.java:<init>(232)) - The configured interval for checkpoint is 0 minutes. Using interval of 0 minutes that is used for deletion instead
2011-08-09 18:49:48,862 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:48,863 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:48,863 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 39779 webServer.getConnectors()[0].getLocalPort() returned 39779
2011-08-09 18:49:48,863 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 39779
2011-08-09 18:49:48,863 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:48,919 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:39779
2011-08-09 18:49:48,920 INFO  namenode.NameNode (NameNode.java:startHttpServer(329)) - Web-server up at: localhost:39779
Starting DataNode 0 with dfs.data.dir: /home/jeff/hadoop-20-warehouse/build/test/data/data1
2011-08-09 18:49:49,103 INFO  datanode.DataNode (DataNode.java:<init>(227)) - Failed to start datanode java.io.IOException: org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /home/jeff/hadoop-20-warehouse/build/test/data/data1 is in an inconsistent state: Cannot rollback to a newer state.
Datanode previous state: LV = -27 CTime = 9223372036854775807 is newer than the namespace state: LV = -27 CTime = 0
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.doRollback(DataStorage.java:373)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.doTransition(DataStorage.java:220)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.recoverTransitionRead(DataStorage.java:148)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.startDataNode(DataNode.java:308)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.<init>(DataNode.java:225)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.makeInstance(DataNode.java:1379)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.instantiateDataNode(DataNode.java:1334)
	at org.apache.hadoop.hdfs.MiniDFSCluster.startDataNodes(MiniDFSCluster.java:485)
	at org.apache.hadoop.hdfs.MiniDFSCluster.startDataNodes(MiniDFSCluster.java:526)
	at org.apache.hadoop.hdfs.TestDFSRollback.startDataNodeShouldFail(TestDFSRollback.java:107)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:189)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
Caused by: org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /home/jeff/hadoop-20-warehouse/build/test/data/data1 is in an inconsistent state: Cannot rollback to a newer state.
Datanode previous state: LV = -27 CTime = 9223372036854775807 is newer than the namespace state: LV = -27 CTime = 0
	at org.apache.hadoop.hdfs.server.datanode.DataStorage$RollbackThread.run(DataStorage.java:404)

Shutting down the Mini HDFS Cluster
2011-08-09 18:49:49,178 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:49,279 WARN  namenode.FSNamesystem (FSNamesystem.java:run(3042)) - ReplicationMonitor thread received InterruptedException.java.lang.InterruptedException: sleep interrupted
2011-08-09 18:49:49,280 INFO  namenode.DecommissionManager (DecommissionManager.java:waitForWork(254)) - Interrupted Monitor
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.waitForWork(DecommissionManager.java:244)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.run(DecommissionManager.java:267)
	at java.lang.Thread.run(Thread.java:662)
2011-08-09 18:49:49,281 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 0 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 0 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits:0 
2011-08-09 18:49:49,284 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 52835
2011-08-09 18:49:49,284 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 52835: exiting
2011-08-09 18:49:49,285 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 52835: exiting
2011-08-09 18:49:49,285 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 52835: exiting
2011-08-09 18:49:49,285 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 3 on 52835: exiting
2011-08-09 18:49:49,285 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 4 on 52835: exiting
2011-08-09 18:49:49,285 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 5 on 52835: exiting
2011-08-09 18:49:49,286 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 6 on 52835: exiting
2011-08-09 18:49:49,286 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 7 on 52835: exiting
2011-08-09 18:49:49,286 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 8 on 52835: exiting
2011-08-09 18:49:49,286 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 9 on 52835: exiting
2011-08-09 18:49:49,287 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 52835
2011-08-09 18:49:49,287 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:49,291 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:49,291 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 6*** NameNode rollback with no edits file: numDirs=1
2011-08-09 18:49:49,354 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:49,361 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:49,361 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:49,362 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:49,362 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:49,362 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:49,367 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:49,368 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:49,368 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:49,368 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:49,372 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:49,372 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:49,372 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:49,375 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   new LV = -27; new CTime = 0
2011-08-09 18:49:49,376 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:49,376 ERROR namenode.FSNamesystem (FSNamesystem.java:<init>(347)) - FSNamesystem initialization failed.
java.io.IOException: Edits file is not found in [/home/jeff/hadoop-20-warehouse/build/test/data/name1]
	at org.apache.hadoop.hdfs.server.namenode.FSImage.loadFSImage(FSImage.java:935)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:457)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.loadFSImage(FSDirectory.java:151)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.initialize(FSNamesystem.java:369)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:345)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:273)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.<init>(NameNode.java:357)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1246)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:342)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:260)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:101)
	at org.apache.hadoop.hdfs.TestDFSRollback.startNameNodeShouldFail(TestDFSRollback.java:94)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:200)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
2011-08-09 18:49:49,377 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:49,377 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 7*** NameNode rollback with no image file: numDirs=1
2011-08-09 18:49:49,433 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:49,436 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:49,437 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:49,437 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:49,437 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:49,437 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:49,442 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:49,442 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:49,443 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:49,443 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:49,446 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:49,446 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:49,447 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:49,450 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   new LV = -27; new CTime = 0
2011-08-09 18:49:49,450 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:49,451 ERROR namenode.FSNamesystem (FSNamesystem.java:<init>(347)) - FSNamesystem initialization failed.
java.io.IOException: Image file is not found in [/home/jeff/hadoop-20-warehouse/build/test/data/name1]
	at org.apache.hadoop.hdfs.server.namenode.FSImage.loadFSImage(FSImage.java:933)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:457)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.loadFSImage(FSDirectory.java:151)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.initialize(FSNamesystem.java:369)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:345)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:273)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.<init>(NameNode.java:357)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1246)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:342)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:260)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:101)
	at org.apache.hadoop.hdfs.TestDFSRollback.startNameNodeShouldFail(TestDFSRollback.java:94)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:209)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
2011-08-09 18:49:49,451 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:49,452 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 8*** NameNode rollback with corrupt version file: numDirs=1
2011-08-09 18:49:49,536 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:49,540 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:49,540 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:49,540 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:49,540 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:49,540 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:49,546 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:49,546 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:49,547 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:49,547 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:49,550 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:49,550 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:49,551 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:49,554 ERROR namenode.FSNamesystem (FSNamesystem.java:<init>(347)) - FSNamesystem initialization failed.
org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /home/jeff/hadoop-20-warehouse/build/test/data/name1 is in an inconsistent state: file VERSION is invalid.
	at org.apache.hadoop.hdfs.server.common.Storage.getFields(Storage.java:647)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.getFields(FSImage.java:636)
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.read(Storage.java:238)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.doRollback(FSImage.java:538)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:452)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.loadFSImage(FSDirectory.java:151)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.initialize(FSNamesystem.java:369)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:345)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:273)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.<init>(NameNode.java:357)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1246)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:342)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:260)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:101)
	at org.apache.hadoop.hdfs.TestDFSRollback.startNameNodeShouldFail(TestDFSRollback.java:94)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:218)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
2011-08-09 18:49:49,555 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:49,555 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 9*** NameNode rollback with old layout version in previous: numDirs=1
2011-08-09 18:49:49,590 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:49,593 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:49,594 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:49,594 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:49,594 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:49,594 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:49,599 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:49,600 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:49,600 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:49,600 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:49,604 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:49,604 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:49,604 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:49,607 ERROR namenode.FSNamesystem (FSNamesystem.java:<init>(347)) - FSNamesystem initialization failed.
org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /home/jeff/hadoop-20-warehouse/build/test/data/name1 is in an inconsistent state: previous fs state should not exist during upgrade. Finalize or rollback first.
	at org.apache.hadoop.hdfs.server.namenode.FSImage.doUpgrade(FSImage.java:474)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:446)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.loadFSImage(FSDirectory.java:151)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.initialize(FSNamesystem.java:369)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:345)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:273)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.<init>(NameNode.java:357)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1246)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:342)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:260)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:101)
	at org.apache.hadoop.hdfs.TestDFSRollback.startNameNodeShouldFail(TestDFSRollback.java:94)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:228)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
2011-08-09 18:49:49,623 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:49,624 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 10*** Normal NameNode rollback: numDirs=2
2011-08-09 18:49:49,679 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:49,682 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:49,682 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:49,682 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:49,682 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:49,682 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:49,687 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:49,688 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:49,688 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:49,688 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:49,691 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:49,691 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:49,692 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:49,695 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   new LV = -27; new CTime = 0
2011-08-09 18:49:49,695 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:49,695 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name2.
   new LV = -27; new CTime = 0
2011-08-09 18:49:49,696 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name2 is complete.
2011-08-09 18:49:49,696 INFO  common.Storage (FSImage.java:loadFSImage(1034)) - Number of files = 4
2011-08-09 18:49:49,697 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 25% of the image
2011-08-09 18:49:49,697 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 50% of the image
2011-08-09 18:49:49,697 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 75% of the image
2011-08-09 18:49:49,697 INFO  common.Storage (FSImage.java:loadFilesUnderConstruction(1499)) - Number of files under construction = 0
2011-08-09 18:49:49,698 INFO  common.Storage (FSImage.java:loadFSImage(1144)) - Image file of size 501 loaded in 0 seconds.
2011-08-09 18:49:49,702 INFO  common.Storage (FSEditLog.java:loadFSEdits(886)) - Edits file /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits of size 648 edits # 6 loaded in 0 seconds.
2011-08-09 18:49:49,703 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:49,724 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:49,727 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:49,731 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:49,740 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:49,761 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:49,779 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:49,779 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:49,783 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:49,783 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:49,802 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2011-08-09 18:49:49,802 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(372)) - Finished loading FSImage in 115 msecs
2011-08-09 18:49:49,802 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(5472)) - STATE* Safe mode ON. 
The ratio of reported blocks 0.00000000 has not reached the threshold 0.99900001. Safe blocks = 0, Total blocks = 16.Safe mode will be turned off automatically.
2011-08-09 18:49:49,802 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(388)) - Skip counting items in the file tree
2011-08-09 18:49:49,803 INFO  util.HostsFileReader (HostsFileReader.java:refresh(80)) - Refreshing hosts (include/exclude) list
2011-08-09 18:49:49,805 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:49,807 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=NameNode, port=52681
2011-08-09 18:49:49,811 INFO  namenode.NameNode (NameNode.java:startServerForClientRequests(396)) - Namenode up at: localhost/127.0.0.1:52681
2011-08-09 18:49:49,811 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:49,812 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 52681: starting
2011-08-09 18:49:49,812 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 52681: starting
2011-08-09 18:49:49,813 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 52681: starting
2011-08-09 18:49:49,813 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 3 on 52681: starting
2011-08-09 18:49:49,813 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 4 on 52681: starting
2011-08-09 18:49:49,814 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 5 on 52681: starting
2011-08-09 18:49:49,814 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 6 on 52681: starting
2011-08-09 18:49:49,814 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 7 on 52681: starting
2011-08-09 18:49:49,814 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 8 on 52681: starting
2011-08-09 18:49:49,815 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 9 on 52681: starting
2011-08-09 18:49:49,815 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 52681: starting
2011-08-09 18:49:49,868 WARN  fs.Trash (Trash.java:<init>(232)) - The configured interval for checkpoint is 0 minutes. Using interval of 0 minutes that is used for deletion instead
2011-08-09 18:49:49,870 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:49,871 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:49,871 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 39029 webServer.getConnectors()[0].getLocalPort() returned 39029
2011-08-09 18:49:49,871 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 39029
2011-08-09 18:49:49,871 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:49,946 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:39029
2011-08-09 18:49:49,947 INFO  namenode.NameNode (NameNode.java:startHttpServer(329)) - Web-server up at: localhost:39029
Shutting down the Mini HDFS Cluster
2011-08-09 18:49:50,030 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:50,132 WARN  namenode.FSNamesystem (FSNamesystem.java:run(3042)) - ReplicationMonitor thread received InterruptedException.java.lang.InterruptedException: sleep interrupted
2011-08-09 18:49:50,132 INFO  namenode.DecommissionManager (DecommissionManager.java:waitForWork(254)) - Interrupted Monitor
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.waitForWork(DecommissionManager.java:244)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.run(DecommissionManager.java:267)
	at java.lang.Thread.run(Thread.java:662)
2011-08-09 18:49:50,133 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 0 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 0 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits:0  /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits:0 
2011-08-09 18:49:50,139 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 52681
2011-08-09 18:49:50,140 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 52681: exiting
2011-08-09 18:49:50,140 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 5 on 52681: exiting
2011-08-09 18:49:50,140 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 4 on 52681: exiting
2011-08-09 18:49:50,140 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 7 on 52681: exiting
2011-08-09 18:49:50,140 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 8 on 52681: exiting
2011-08-09 18:49:50,140 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 52681: exiting
2011-08-09 18:49:50,141 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 6 on 52681: exiting
2011-08-09 18:49:50,141 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 9 on 52681: exiting
2011-08-09 18:49:50,141 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 52681: exiting
2011-08-09 18:49:50,142 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 52681
2011-08-09 18:49:50,142 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 3 on 52681: exiting
2011-08-09 18:49:50,143 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:50,144 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:50,144 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 11*** Normal DataNode rollback: numDirs=2
2011-08-09 18:49:50,206 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:50,209 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:50,209 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:50,210 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:50,210 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:50,210 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:50,216 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:50,217 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:50,217 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:50,217 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:50,220 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:50,220 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:50,221 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:50,224 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   new LV = -27; new CTime = 0
2011-08-09 18:49:50,224 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:50,225 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name2.
   new LV = -27; new CTime = 0
2011-08-09 18:49:50,225 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name2 is complete.
2011-08-09 18:49:50,226 INFO  common.Storage (FSImage.java:loadFSImage(1034)) - Number of files = 4
2011-08-09 18:49:50,226 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 25% of the image
2011-08-09 18:49:50,226 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 50% of the image
2011-08-09 18:49:50,226 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 75% of the image
2011-08-09 18:49:50,226 INFO  common.Storage (FSImage.java:loadFilesUnderConstruction(1499)) - Number of files under construction = 0
2011-08-09 18:49:50,227 INFO  common.Storage (FSImage.java:loadFSImage(1144)) - Image file of size 501 loaded in 0 seconds.
2011-08-09 18:49:50,228 INFO  common.Storage (FSEditLog.java:loadFSEdits(886)) - Edits file /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits of size 648 edits # 6 loaded in 0 seconds.
2011-08-09 18:49:50,228 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:50,344 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:50,349 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:50,367 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:50,367 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:50,371 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:50,387 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:50,387 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:50,391 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:50,392 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:50,411 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2011-08-09 18:49:50,411 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(372)) - Finished loading FSImage in 195 msecs
2011-08-09 18:49:50,412 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(5472)) - STATE* Safe mode ON. 
The ratio of reported blocks 0.00000000 has not reached the threshold 0.99900001. Safe blocks = 0, Total blocks = 16.Safe mode will be turned off automatically.
2011-08-09 18:49:50,412 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(388)) - Skip counting items in the file tree
2011-08-09 18:49:50,413 INFO  util.HostsFileReader (HostsFileReader.java:refresh(80)) - Refreshing hosts (include/exclude) list
2011-08-09 18:49:50,415 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:50,417 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=NameNode, port=44923
2011-08-09 18:49:50,418 INFO  namenode.NameNode (NameNode.java:startServerForClientRequests(396)) - Namenode up at: localhost/127.0.0.1:44923
2011-08-09 18:49:50,418 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:50,465 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 44923: starting
2011-08-09 18:49:50,465 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 44923: starting
2011-08-09 18:49:50,466 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 44923: starting
2011-08-09 18:49:50,466 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 3 on 44923: starting
2011-08-09 18:49:50,466 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 4 on 44923: starting
2011-08-09 18:49:50,466 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 5 on 44923: starting
2011-08-09 18:49:50,466 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 6 on 44923: starting
2011-08-09 18:49:50,467 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 7 on 44923: starting
2011-08-09 18:49:50,467 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 8 on 44923: starting
2011-08-09 18:49:50,467 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 9 on 44923: starting
2011-08-09 18:49:50,468 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 44923: starting
2011-08-09 18:49:50,518 WARN  fs.Trash (Trash.java:<init>(232)) - The configured interval for checkpoint is 0 minutes. Using interval of 0 minutes that is used for deletion instead
2011-08-09 18:49:50,519 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:50,521 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:50,521 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 50870 webServer.getConnectors()[0].getLocalPort() returned 50870
2011-08-09 18:49:50,521 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 50870
2011-08-09 18:49:50,521 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:50,565 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:50870
2011-08-09 18:49:50,566 INFO  namenode.NameNode (NameNode.java:startHttpServer(329)) - Web-server up at: localhost:50870
Starting DataNode 0 with dfs.data.dir: /home/jeff/hadoop-20-warehouse/build/test/data/data1,/home/jeff/hadoop-20-warehouse/build/test/data/data2
2011-08-09 18:49:50,797 INFO  common.Storage (DataStorage.java:run(409)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/data1.
   target LV = -27; target CTime = 0
2011-08-09 18:49:50,799 INFO  common.Storage (DataStorage.java:run(422)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/data1 is complete.
2011-08-09 18:49:50,839 INFO  common.Storage (DataStorage.java:run(409)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/data2.
   target LV = -27; target CTime = 0
2011-08-09 18:49:50,841 INFO  common.Storage (DataStorage.java:run(422)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/data2 is complete.
2011-08-09 18:49:51,014 INFO  datanode.DataNode (FSDataset.java:registerMBean(1597)) - Registered FSDatasetStatusMBean
2011-08-09 18:49:51,015 INFO  datanode.DataNode (DataNode.java:startDataNode(327)) - Opened info server at 41402
2011-08-09 18:49:51,016 INFO  datanode.DataNode (DataXceiverServer.java:<init>(75)) - Balancing bandwith is 1048576 bytes/s
2011-08-09 18:49:51,016 INFO  datanode.DataNode (DataNode.java:startDataNode(359)) - Periodic Block Verification is disabled because verification is turned off by configuration.
2011-08-09 18:49:51,019 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:51,019 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:51,020 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 37420 webServer.getConnectors()[0].getLocalPort() returned 37420
2011-08-09 18:49:51,020 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 37420
2011-08-09 18:49:51,020 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:51,136 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:37420
2011-08-09 18:49:51,138 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=DataNode, sessionId=null - already initialized
2011-08-09 18:49:51,142 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:51,145 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=DataNode, port=53882
2011-08-09 18:49:51,146 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:51,147 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 53882: starting
2011-08-09 18:49:51,147 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 53882: starting
2011-08-09 18:49:51,190 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 53882: starting
2011-08-09 18:49:51,190 INFO  datanode.DataNode (DataNode.java:startDataNode(418)) - dnRegistration = DatanodeRegistration(m3vm6.tuenti.local:41402, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=37420, ipcPort=53882)
2011-08-09 18:49:51,191 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 53882: starting
2011-08-09 18:49:51,194 INFO  hdfs.StateChange (FSNamesystem.java:registerDatanode(2757)) - BLOCK* NameSystem.registerDatanode: node registration from 127.0.0.1:41402 storage DS-1952448891-10.0.62.238-56645-1312908579804
2011-08-09 18:49:51,195 INFO  net.NetworkTopology (NetworkTopology.java:add(328)) - Adding a new node: /default-rack/127.0.0.1:41402
2011-08-09 18:49:51,196 INFO  datanode.DataNode (DataNode.java:run(1274)) - DatanodeRegistration(127.0.0.1:41402, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=37420, ipcPort=53882)In DataNode.run, data = FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/data1/current,/home/jeff/hadoop-20-warehouse/build/test/data/data2/current'}
2011-08-09 18:49:51,197 INFO  datanode.DataNode (DataNode.java:offerService(756)) - using BLOCKREPORT_INTERVAL of 10000msec Initial delay: 0msec
2011-08-09 18:49:51,209 INFO  datanode.DataNode (FSDataset.java:getBlockInfo(601)) - Finished generating block report for 2 volumes in 0 seconds
2011-08-09 18:49:51,212 INFO  hdfs.StateChange (FSNamesystem.java:processReport(3701)) - BLOCK* NameSystem.processReport: from 127.0.0.1:41402 16 blocks shortCircuit first report.
2011-08-09 18:49:51,213 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(5294)) - initializing replication queues
2011-08-09 18:49:51,217 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4047)) - Total number of blocks = 16
2011-08-09 18:49:51,217 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4048)) - Number of invalid blocks = 0
2011-08-09 18:49:51,218 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4049)) - Number of under-replicated blocks = 1
2011-08-09 18:49:51,218 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4050)) - Number of  over-replicated blocks = 0
2011-08-09 18:49:51,220 INFO  hdfs.StateChange (FSNamesystem.java:leave(5269)) - STATE* Leaving safe mode after 1 secs.
2011-08-09 18:49:51,220 INFO  hdfs.StateChange (FSNamesystem.java:leave(5274)) - STATE* Safe mode is OFF.
2011-08-09 18:49:51,221 INFO  hdfs.StateChange (FSNamesystem.java:leave(5283)) - STATE* Network topology has 1 racks and 1 datanodes
2011-08-09 18:49:51,221 INFO  hdfs.StateChange (FSNamesystem.java:leave(5286)) - STATE* UnderReplicatedBlocks has 1 blocks
2011-08-09 18:49:51,222 INFO  datanode.DataNode (DataNode.java:offerService(839)) - BlockReport of 16 blocks got processed in 20 msecs
Shutting down the Mini HDFS Cluster
Shutting down DataNode 0
2011-08-09 18:49:51,303 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:51,404 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 53882
2011-08-09 18:49:51,405 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 53882: exiting
2011-08-09 18:49:51,405 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 53882: exiting
2011-08-09 18:49:51,405 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 53882: exiting
2011-08-09 18:49:51,405 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 53882
2011-08-09 18:49:51,407 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:51,407 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 1
2011-08-09 18:49:51,408 WARN  datanode.DataNode (DataXceiverServer.java:run(138)) - DatanodeRegistration(127.0.0.1:41402, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=37420, ipcPort=53882):DataXceiveServer: java.nio.channels.AsynchronousCloseException
	at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:152)
	at sun.nio.ch.ServerSocketAdaptor.accept(ServerSocketAdaptor.java:84)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiverServer.run(DataXceiverServer.java:131)
	at java.lang.Thread.run(Thread.java:662)

2011-08-09 18:49:52,408 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 18:49:52,409 INFO  datanode.DataNode (DataNode.java:run(1294)) - DatanodeRegistration(127.0.0.1:41402, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=37420, ipcPort=53882):Finishing DataNode in: FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/data1/current,/home/jeff/hadoop-20-warehouse/build/test/data/data2/current'}
2011-08-09 18:49:52,410 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 53882
2011-08-09 18:49:52,410 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 18:49:52,411 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(128)) - Shutting down all async disk service threads...
2011-08-09 18:49:52,411 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(137)) - All async disk service threads have been shut down.
2011-08-09 18:49:52,412 WARN  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(125)) - AsyncDiskService has already shut down.
2011-08-09 18:49:52,458 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:52,560 WARN  namenode.FSNamesystem (FSNamesystem.java:run(3042)) - ReplicationMonitor thread received InterruptedException.java.lang.InterruptedException: sleep interrupted
2011-08-09 18:49:52,560 INFO  namenode.DecommissionManager (DecommissionManager.java:waitForWork(254)) - Interrupted Monitor
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.waitForWork(DecommissionManager.java:244)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.run(DecommissionManager.java:267)
	at java.lang.Thread.run(Thread.java:662)
2011-08-09 18:49:52,561 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 0 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 0 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits:0  /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits:0 
2011-08-09 18:49:52,568 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 44923
2011-08-09 18:49:52,568 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 44923: exiting
2011-08-09 18:49:52,569 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 44923: exiting
2011-08-09 18:49:52,569 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 44923: exiting
2011-08-09 18:49:52,569 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 4 on 44923: exiting
2011-08-09 18:49:52,569 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 6 on 44923: exiting
2011-08-09 18:49:52,569 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 5 on 44923: exiting
2011-08-09 18:49:52,570 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 8 on 44923: exiting
2011-08-09 18:49:52,570 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 7 on 44923: exiting
2011-08-09 18:49:52,570 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 3 on 44923: exiting
2011-08-09 18:49:52,571 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 9 on 44923: exiting
2011-08-09 18:49:52,571 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 44923
2011-08-09 18:49:52,576 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:52,576 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 12*** NameNode rollback without existing previous dir: numDirs=2
2011-08-09 18:49:52,585 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:52,630 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:52,633 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:52,633 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:52,633 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:52,634 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:52,634 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:52,641 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:52,642 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:52,642 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:52,642 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:52,645 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:52,646 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:52,647 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:52,650 INFO  common.Storage (FSImage.java:doRollback(532)) - Storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1 does not contain previous fs state.
2011-08-09 18:49:52,651 INFO  common.Storage (FSImage.java:doRollback(532)) - Storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name2 does not contain previous fs state.
2011-08-09 18:49:52,651 ERROR namenode.FSNamesystem (FSNamesystem.java:<init>(347)) - FSNamesystem initialization failed.
java.io.IOException: Cannot rollback. None of the storage directories contain previous fs state.
	at org.apache.hadoop.hdfs.server.namenode.FSImage.doRollback(FSImage.java:542)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:452)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.loadFSImage(FSDirectory.java:151)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.initialize(FSNamesystem.java:369)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:345)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:273)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.<init>(NameNode.java:357)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1246)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:342)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:260)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:101)
	at org.apache.hadoop.hdfs.TestDFSRollback.startNameNodeShouldFail(TestDFSRollback.java:94)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:152)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
2011-08-09 18:49:52,652 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:52,653 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 13*** DataNode rollback without existing previous dir: numDirs=2
2011-08-09 18:49:52,684 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:52,687 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:52,688 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:52,688 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:52,688 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:52,688 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:52,696 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:52,697 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:52,697 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:52,697 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:52,701 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:52,701 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:52,702 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:52,706 INFO  common.Storage (FSImage.java:loadFSImage(1034)) - Number of files = 4
2011-08-09 18:49:52,706 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 25% of the image
2011-08-09 18:49:52,706 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 50% of the image
2011-08-09 18:49:52,706 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 75% of the image
2011-08-09 18:49:52,707 INFO  common.Storage (FSImage.java:loadFilesUnderConstruction(1499)) - Number of files under construction = 0
2011-08-09 18:49:52,707 INFO  common.Storage (FSImage.java:loadFSImage(1144)) - Image file of size 501 loaded in 0 seconds.
2011-08-09 18:49:52,708 INFO  common.Storage (FSEditLog.java:loadFSEdits(886)) - Edits file /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits of size 648 edits # 6 loaded in 0 seconds.
2011-08-09 18:49:52,709 INFO  common.Storage (FSImage.java:doUpgrade(491)) - Upgrading image directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   old LV = -27; old CTime = 0.
   new LV = -27; new CTime = 1312908592708
2011-08-09 18:49:52,718 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:52,718 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:52,751 INFO  common.Storage (FSImage.java:doUpgrade(514)) - Upgrade of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:52,752 INFO  common.Storage (FSImage.java:doUpgrade(491)) - Upgrading image directory /home/jeff/hadoop-20-warehouse/build/test/data/name2.
   old LV = -27; old CTime = 0.
   new LV = -27; new CTime = 1312908592708
2011-08-09 18:49:52,754 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:52,755 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:52,766 INFO  common.Storage (FSImage.java:doUpgrade(514)) - Upgrade of /home/jeff/hadoop-20-warehouse/build/test/data/name2 is complete.
2011-08-09 18:49:52,766 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:52,767 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:52,768 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2011-08-09 18:49:52,768 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(372)) - Finished loading FSImage in 72 msecs
2011-08-09 18:49:52,768 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(5472)) - STATE* Safe mode ON. 
The ratio of reported blocks 0.00000000 has not reached the threshold 0.99900001. Safe blocks = 0, Total blocks = 16.Safe mode will be turned off automatically.
2011-08-09 18:49:52,768 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(388)) - Skip counting items in the file tree
2011-08-09 18:49:52,770 INFO  util.HostsFileReader (HostsFileReader.java:refresh(80)) - Refreshing hosts (include/exclude) list
2011-08-09 18:49:52,794 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:52,796 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=NameNode, port=56935
2011-08-09 18:49:52,797 INFO  namenode.NameNode (NameNode.java:startServerForClientRequests(396)) - Namenode up at: localhost/127.0.0.1:56935
2011-08-09 18:49:52,797 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:52,838 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 56935: starting
2011-08-09 18:49:52,838 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 56935: starting
2011-08-09 18:49:52,838 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 56935: starting
2011-08-09 18:49:52,838 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 3 on 56935: starting
2011-08-09 18:49:52,838 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 4 on 56935: starting
2011-08-09 18:49:52,839 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 5 on 56935: starting
2011-08-09 18:49:52,839 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 6 on 56935: starting
2011-08-09 18:49:52,839 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 7 on 56935: starting
2011-08-09 18:49:52,839 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 8 on 56935: starting
2011-08-09 18:49:52,839 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 9 on 56935: starting
2011-08-09 18:49:52,840 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 56935: starting
2011-08-09 18:49:52,848 WARN  fs.Trash (Trash.java:<init>(232)) - The configured interval for checkpoint is 0 minutes. Using interval of 0 minutes that is used for deletion instead
2011-08-09 18:49:52,849 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:52,850 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:52,850 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 44868 webServer.getConnectors()[0].getLocalPort() returned 44868
2011-08-09 18:49:52,850 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 44868
2011-08-09 18:49:52,850 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:53,057 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:44868
2011-08-09 18:49:53,058 INFO  namenode.NameNode (NameNode.java:startHttpServer(329)) - Web-server up at: localhost:44868
Starting DataNode 0 with dfs.data.dir: /home/jeff/hadoop-20-warehouse/build/test/data/data1,/home/jeff/hadoop-20-warehouse/build/test/data/data2
2011-08-09 18:49:53,202 INFO  common.Storage (DataStorage.java:run(279)) - Upgrading storage directory /home/jeff/hadoop-20-warehouse/build/test/data/data1.
   old LV = -27; old CTime = 0.
   new LV = -27; new CTime = 1312908592708
2011-08-09 18:49:53,202 INFO  common.Storage (DataStorage.java:run(279)) - Upgrading storage directory /home/jeff/hadoop-20-warehouse/build/test/data/data2.
   old LV = -27; old CTime = 0.
   new LV = -27; new CTime = 1312908592708
2011-08-09 18:49:53,282 INFO  common.Storage (DataStorage.java:run(297)) - Completed upgrading storage directory /home/jeff/hadoop-20-warehouse/build/test/data/data1HardLinkStats: 1 Directories, including 0 Empty Directories, 0 single Link operations, 1 multi-Link operations, linking 32 files, total 32 linkable files.  Also physically copied 1 other files.
2011-08-09 18:49:53,284 INFO  common.Storage (DataStorage.java:run(297)) - Completed upgrading storage directory /home/jeff/hadoop-20-warehouse/build/test/data/data2HardLinkStats: 1 Directories, including 0 Empty Directories, 0 single Link operations, 1 multi-Link operations, linking 32 files, total 32 linkable files.  Also physically copied 1 other files.
2011-08-09 18:49:53,326 INFO  common.Storage (DataStorage.java:doUpgrade(348)) - Upgrade of /home/jeff/hadoop-20-warehouse/build/test/data/data1 is complete.
2011-08-09 18:49:53,329 INFO  common.Storage (DataStorage.java:doUpgrade(348)) - Upgrade of /home/jeff/hadoop-20-warehouse/build/test/data/data2 is complete.
2011-08-09 18:49:53,477 INFO  datanode.DataNode (FSDataset.java:registerMBean(1597)) - Registered FSDatasetStatusMBean
2011-08-09 18:49:53,486 INFO  datanode.DataNode (DataNode.java:startDataNode(327)) - Opened info server at 41060
2011-08-09 18:49:53,486 INFO  datanode.DataNode (DataXceiverServer.java:<init>(75)) - Balancing bandwith is 1048576 bytes/s
2011-08-09 18:49:53,486 INFO  datanode.DataNode (DataNode.java:startDataNode(359)) - Periodic Block Verification is disabled because verification is turned off by configuration.
2011-08-09 18:49:53,489 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:53,490 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:53,490 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 59452 webServer.getConnectors()[0].getLocalPort() returned 59452
2011-08-09 18:49:53,490 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 59452
2011-08-09 18:49:53,491 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:53,559 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:59452
2011-08-09 18:49:53,561 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=DataNode, sessionId=null - already initialized
2011-08-09 18:49:53,566 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:53,568 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=DataNode, port=56081
2011-08-09 18:49:53,569 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:53,570 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 56081: starting
2011-08-09 18:49:53,622 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 56081: starting
2011-08-09 18:49:53,622 INFO  datanode.DataNode (DataNode.java:startDataNode(418)) - dnRegistration = DatanodeRegistration(m3vm6.tuenti.local:41060, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=59452, ipcPort=56081)
2011-08-09 18:49:53,622 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 56081: starting
2011-08-09 18:49:53,623 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 56081: starting
2011-08-09 18:49:53,625 INFO  hdfs.StateChange (FSNamesystem.java:registerDatanode(2757)) - BLOCK* NameSystem.registerDatanode: node registration from 127.0.0.1:41060 storage DS-1952448891-10.0.62.238-56645-1312908579804
2011-08-09 18:49:53,626 INFO  net.NetworkTopology (NetworkTopology.java:add(328)) - Adding a new node: /default-rack/127.0.0.1:41060
2011-08-09 18:49:53,627 INFO  datanode.DataNode (DataNode.java:run(1274)) - DatanodeRegistration(127.0.0.1:41060, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=59452, ipcPort=56081)In DataNode.run, data = FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/data1/current,/home/jeff/hadoop-20-warehouse/build/test/data/data2/current'}
2011-08-09 18:49:53,628 INFO  datanode.DataNode (DataNode.java:offerService(756)) - using BLOCKREPORT_INTERVAL of 10000msec Initial delay: 0msec
Shutting down the Mini HDFS Cluster
Shutting down DataNode 0
2011-08-09 18:49:53,643 INFO  datanode.DataNode (FSDataset.java:getBlockInfo(601)) - Finished generating block report for 2 volumes in 0 seconds
2011-08-09 18:49:53,644 INFO  hdfs.StateChange (FSNamesystem.java:processReport(3701)) - BLOCK* NameSystem.processReport: from 127.0.0.1:41060 16 blocks shortCircuit first report.
2011-08-09 18:49:53,645 INFO  namenode.FSNamesystem (FSNamesystem.java:initializeReplQueues(5294)) - initializing replication queues
2011-08-09 18:49:53,649 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4047)) - Total number of blocks = 16
2011-08-09 18:49:53,650 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4048)) - Number of invalid blocks = 0
2011-08-09 18:49:53,650 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4049)) - Number of under-replicated blocks = 1
2011-08-09 18:49:53,650 INFO  namenode.FSNamesystem (FSNamesystem.java:processMisReplicatedBlocks(4050)) - Number of  over-replicated blocks = 0
2011-08-09 18:49:53,661 INFO  hdfs.StateChange (FSNamesystem.java:leave(5269)) - STATE* Leaving safe mode after 0 secs.
2011-08-09 18:49:53,662 INFO  hdfs.StateChange (FSNamesystem.java:leave(5274)) - STATE* Safe mode is OFF.
2011-08-09 18:49:53,662 INFO  hdfs.StateChange (FSNamesystem.java:leave(5283)) - STATE* Network topology has 1 racks and 1 datanodes
2011-08-09 18:49:53,663 INFO  hdfs.StateChange (FSNamesystem.java:leave(5286)) - STATE* UnderReplicatedBlocks has 1 blocks
2011-08-09 18:49:53,664 INFO  datanode.DataNode (DataNode.java:offerService(839)) - BlockReport of 16 blocks got processed in 29 msecs
2011-08-09 18:49:53,735 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:53,736 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 56081
2011-08-09 18:49:53,737 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 56081: exiting
2011-08-09 18:49:53,737 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 56081: exiting
2011-08-09 18:49:53,737 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 56081
2011-08-09 18:49:53,737 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 56081: exiting
2011-08-09 18:49:53,738 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:53,739 WARN  datanode.DataNode (DataXceiverServer.java:run(138)) - DatanodeRegistration(127.0.0.1:41060, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=59452, ipcPort=56081):DataXceiveServer: java.nio.channels.AsynchronousCloseException
	at java.nio.channels.spi.AbstractInterruptibleChannel.end(AbstractInterruptibleChannel.java:185)
	at sun.nio.ch.ServerSocketChannelImpl.accept(ServerSocketChannelImpl.java:152)
	at sun.nio.ch.ServerSocketAdaptor.accept(ServerSocketAdaptor.java:84)
	at org.apache.hadoop.hdfs.server.datanode.DataXceiverServer.run(DataXceiverServer.java:131)
	at java.lang.Thread.run(Thread.java:662)

2011-08-09 18:49:53,740 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 18:49:53,740 INFO  datanode.DataNode (DataNode.java:run(1294)) - DatanodeRegistration(127.0.0.1:41060, storageID=DS-1952448891-10.0.62.238-56645-1312908579804, infoPort=59452, ipcPort=56081):Finishing DataNode in: FSDataset{dirpath='/home/jeff/hadoop-20-warehouse/build/test/data/data1/current,/home/jeff/hadoop-20-warehouse/build/test/data/data2/current'}
2011-08-09 18:49:53,741 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 56081
2011-08-09 18:49:53,741 INFO  datanode.DataNode (DataNode.java:shutdown(632)) - Waiting for threadgroup to exit, active threads is 0
2011-08-09 18:49:53,742 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(128)) - Shutting down all async disk service threads...
2011-08-09 18:49:53,742 INFO  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(137)) - All async disk service threads have been shut down.
2011-08-09 18:49:53,743 WARN  datanode.FSDatasetAsyncDiskService (FSDatasetAsyncDiskService.java:shutdown(125)) - AsyncDiskService has already shut down.
2011-08-09 18:49:53,800 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:53,902 WARN  namenode.FSNamesystem (FSNamesystem.java:run(3042)) - ReplicationMonitor thread received InterruptedException.java.lang.InterruptedException: sleep interrupted
2011-08-09 18:49:53,902 INFO  namenode.DecommissionManager (DecommissionManager.java:waitForWork(254)) - Interrupted Monitor
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.waitForWork(DecommissionManager.java:244)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.run(DecommissionManager.java:267)
	at java.lang.Thread.run(Thread.java:662)
2011-08-09 18:49:53,903 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 0 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 0 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits:0  /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits:0 
2011-08-09 18:49:53,910 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 56935
2011-08-09 18:49:53,910 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 56935: exiting
2011-08-09 18:49:53,911 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 56935: exiting
2011-08-09 18:49:53,911 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 3 on 56935: exiting
2011-08-09 18:49:53,911 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 56935: exiting
2011-08-09 18:49:53,911 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 4 on 56935: exiting
2011-08-09 18:49:53,912 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 6 on 56935: exiting
2011-08-09 18:49:53,912 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 5 on 56935: exiting
2011-08-09 18:49:53,912 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 7 on 56935: exiting
2011-08-09 18:49:53,913 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 8 on 56935: exiting
2011-08-09 18:49:53,913 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 9 on 56935: exiting
2011-08-09 18:49:53,914 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 56935
2011-08-09 18:49:53,915 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:53,921 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:53,921 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 14*** DataNode rollback with future stored layout version in previous: numDirs=2
2011-08-09 18:49:53,978 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:53,981 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:53,981 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:53,981 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:53,982 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:53,982 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:53,987 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:53,987 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:53,987 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:53,987 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:53,990 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:53,991 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:53,993 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:53,997 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   new LV = -27; new CTime = 0
2011-08-09 18:49:53,998 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:53,998 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name2.
   new LV = -27; new CTime = 0
2011-08-09 18:49:53,998 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name2 is complete.
2011-08-09 18:49:53,999 INFO  common.Storage (FSImage.java:loadFSImage(1034)) - Number of files = 4
2011-08-09 18:49:54,000 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 25% of the image
2011-08-09 18:49:54,000 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 50% of the image
2011-08-09 18:49:54,000 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 75% of the image
2011-08-09 18:49:54,000 INFO  common.Storage (FSImage.java:loadFilesUnderConstruction(1499)) - Number of files under construction = 0
2011-08-09 18:49:54,001 INFO  common.Storage (FSImage.java:loadFSImage(1144)) - Image file of size 501 loaded in 0 seconds.
2011-08-09 18:49:54,002 INFO  common.Storage (FSEditLog.java:loadFSEdits(886)) - Edits file /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits of size 648 edits # 6 loaded in 0 seconds.
2011-08-09 18:49:54,003 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,034 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,038 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,043 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,051 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:54,052 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,059 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:54,059 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,065 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,066 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,085 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2011-08-09 18:49:54,086 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(372)) - Finished loading FSImage in 100 msecs
2011-08-09 18:49:54,086 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(5472)) - STATE* Safe mode ON. 
The ratio of reported blocks 0.00000000 has not reached the threshold 0.99900001. Safe blocks = 0, Total blocks = 16.Safe mode will be turned off automatically.
2011-08-09 18:49:54,086 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(388)) - Skip counting items in the file tree
2011-08-09 18:49:54,088 INFO  util.HostsFileReader (HostsFileReader.java:refresh(80)) - Refreshing hosts (include/exclude) list
2011-08-09 18:49:54,089 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:54,092 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=NameNode, port=51359
2011-08-09 18:49:54,092 INFO  namenode.NameNode (NameNode.java:startServerForClientRequests(396)) - Namenode up at: localhost/127.0.0.1:51359
2011-08-09 18:49:54,093 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:54,139 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 51359: starting
2011-08-09 18:49:54,140 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 51359: starting
2011-08-09 18:49:54,140 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 3 on 51359: starting
2011-08-09 18:49:54,141 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 4 on 51359: starting
2011-08-09 18:49:54,141 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 5 on 51359: starting
2011-08-09 18:49:54,140 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 51359: starting
2011-08-09 18:49:54,141 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 6 on 51359: starting
2011-08-09 18:49:54,141 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 7 on 51359: starting
2011-08-09 18:49:54,142 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 51359: starting
2011-08-09 18:49:54,142 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 8 on 51359: starting
2011-08-09 18:49:54,143 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 9 on 51359: starting
2011-08-09 18:49:54,192 WARN  fs.Trash (Trash.java:<init>(232)) - The configured interval for checkpoint is 0 minutes. Using interval of 0 minutes that is used for deletion instead
2011-08-09 18:49:54,194 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:54,194 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:54,195 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 51382 webServer.getConnectors()[0].getLocalPort() returned 51382
2011-08-09 18:49:54,195 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 51382
2011-08-09 18:49:54,195 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:54,298 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:51382
2011-08-09 18:49:54,299 INFO  namenode.NameNode (NameNode.java:startHttpServer(329)) - Web-server up at: localhost:51382
Starting DataNode 0 with dfs.data.dir: /home/jeff/hadoop-20-warehouse/build/test/data/data1,/home/jeff/hadoop-20-warehouse/build/test/data/data2
2011-08-09 18:49:54,706 INFO  datanode.DataNode (DataNode.java:<init>(227)) - Failed to start datanode java.io.IOException: org.apache.hadoop.hdfs.server.common.IncorrectVersionException: Unexpected version of storage directory /home/jeff/hadoop-20-warehouse/build/test/data/data1. Reported: -2147483648. Expecting = -27.
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.doRollback(DataStorage.java:373)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.doTransition(DataStorage.java:220)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.recoverTransitionRead(DataStorage.java:148)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.startDataNode(DataNode.java:308)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.<init>(DataNode.java:225)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.makeInstance(DataNode.java:1379)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.instantiateDataNode(DataNode.java:1334)
	at org.apache.hadoop.hdfs.MiniDFSCluster.startDataNodes(MiniDFSCluster.java:485)
	at org.apache.hadoop.hdfs.MiniDFSCluster.startDataNodes(MiniDFSCluster.java:526)
	at org.apache.hadoop.hdfs.TestDFSRollback.startDataNodeShouldFail(TestDFSRollback.java:107)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:174)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
Caused by: org.apache.hadoop.hdfs.server.common.IncorrectVersionException: Unexpected version of storage directory /home/jeff/hadoop-20-warehouse/build/test/data/data1. Reported: -2147483648. Expecting = -27.
	at org.apache.hadoop.hdfs.server.common.Storage.getFields(Storage.java:662)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.getFields(DataStorage.java:173)
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.read(Storage.java:238)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage$RollbackThread.run(DataStorage.java:398)

Shutting down the Mini HDFS Cluster
2011-08-09 18:49:54,708 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:54,809 WARN  namenode.FSNamesystem (FSNamesystem.java:run(3042)) - ReplicationMonitor thread received InterruptedException.java.lang.InterruptedException: sleep interrupted
2011-08-09 18:49:54,810 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 0 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 0 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits:0  /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits:0 
2011-08-09 18:49:54,809 INFO  namenode.DecommissionManager (DecommissionManager.java:waitForWork(254)) - Interrupted Monitor
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.waitForWork(DecommissionManager.java:244)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.run(DecommissionManager.java:267)
	at java.lang.Thread.run(Thread.java:662)
2011-08-09 18:49:54,817 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 51359
2011-08-09 18:49:54,817 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 5 on 51359: exiting
2011-08-09 18:49:54,817 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 6 on 51359: exiting
2011-08-09 18:49:54,817 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 51359: exiting
2011-08-09 18:49:54,818 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 7 on 51359: exiting
2011-08-09 18:49:54,818 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 51359: exiting
2011-08-09 18:49:54,818 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 8 on 51359: exiting
2011-08-09 18:49:54,818 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 3 on 51359: exiting
2011-08-09 18:49:54,818 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 9 on 51359: exiting
2011-08-09 18:49:54,818 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 4 on 51359: exiting
2011-08-09 18:49:54,818 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 51359
2011-08-09 18:49:54,819 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 51359: exiting
2011-08-09 18:49:54,820 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:54,826 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:54,827 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 15*** DataNode rollback with newer fsscTime in previous: numDirs=2
2011-08-09 18:49:54,886 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:54,889 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:54,889 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:54,889 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:54,889 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:54,889 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:54,895 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:54,895 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:54,895 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:54,895 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:54,899 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:54,899 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:54,900 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:54,903 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   new LV = -27; new CTime = 0
2011-08-09 18:49:54,903 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:54,904 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name2.
   new LV = -27; new CTime = 0
2011-08-09 18:49:54,904 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name2 is complete.
2011-08-09 18:49:54,905 INFO  common.Storage (FSImage.java:loadFSImage(1034)) - Number of files = 4
2011-08-09 18:49:54,905 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 25% of the image
2011-08-09 18:49:54,905 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 50% of the image
2011-08-09 18:49:54,905 INFO  common.Storage (FSImage.java:loadFSImage(1043)) - Loaded 75% of the image
2011-08-09 18:49:54,906 INFO  common.Storage (FSImage.java:loadFilesUnderConstruction(1499)) - Number of files under construction = 0
2011-08-09 18:49:54,906 INFO  common.Storage (FSImage.java:loadFSImage(1144)) - Image file of size 501 loaded in 0 seconds.
2011-08-09 18:49:54,907 INFO  common.Storage (FSEditLog.java:loadFSEdits(886)) - Edits file /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits of size 648 edits # 6 loaded in 0 seconds.
2011-08-09 18:49:54,907 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,928 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,931 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,937 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,948 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:54,948 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,953 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits.new is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,960 INFO  common.Storage (FSImage.java:saveFSImage(1268)) - Image file of size 829 saved in 0 seconds.
2011-08-09 18:49:54,960 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,961 INFO  namenode.FSNamesystem (FSEditLog.java:<init>(157)) - Edit Log preallocate size for /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits is 1048576 bytes  and initial size of edits buffer is 524288 bytes. Max number of buffered transactions is 10000
2011-08-09 18:49:54,978 INFO  namenode.NameCache (NameCache.java:initialized(143)) - initialized with 0 entries 0 lookups
2011-08-09 18:49:54,978 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(372)) - Finished loading FSImage in 83 msecs
2011-08-09 18:49:54,979 INFO  hdfs.StateChange (FSNamesystem.java:reportStatus(5472)) - STATE* Safe mode ON. 
The ratio of reported blocks 0.00000000 has not reached the threshold 0.99900001. Safe blocks = 0, Total blocks = 16.Safe mode will be turned off automatically.
2011-08-09 18:49:54,979 INFO  namenode.FSNamesystem (FSNamesystem.java:initialize(388)) - Skip counting items in the file tree
2011-08-09 18:49:54,980 INFO  util.HostsFileReader (HostsFileReader.java:refresh(80)) - Refreshing hosts (include/exclude) list
2011-08-09 18:49:54,996 INFO  ipc.Server (Server.java:run(307)) - Starting SocketReader
2011-08-09 18:49:54,998 INFO  metrics.RpcMetrics (RpcMetrics.java:<init>(59)) - Initializing RPC Metrics with hostName=NameNode, port=60758
2011-08-09 18:49:54,998 INFO  namenode.NameNode (NameNode.java:startServerForClientRequests(396)) - Namenode up at: localhost/127.0.0.1:60758
2011-08-09 18:49:54,999 INFO  ipc.Server (Server.java:run(581)) - IPC Server Responder: starting
2011-08-09 18:49:55,002 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 0 on 60758: starting
2011-08-09 18:49:55,002 INFO  ipc.Server (Server.java:run(408)) - IPC Server listener on 60758: starting
2011-08-09 18:49:55,003 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 1 on 60758: starting
2011-08-09 18:49:55,003 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 2 on 60758: starting
2011-08-09 18:49:55,004 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 3 on 60758: starting
2011-08-09 18:49:55,004 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 4 on 60758: starting
2011-08-09 18:49:55,004 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 5 on 60758: starting
2011-08-09 18:49:55,004 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 6 on 60758: starting
2011-08-09 18:49:55,005 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 7 on 60758: starting
2011-08-09 18:49:55,005 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 8 on 60758: starting
2011-08-09 18:49:55,006 INFO  ipc.Server (Server.java:run(1044)) - IPC Server handler 9 on 60758: starting
2011-08-09 18:49:55,055 WARN  fs.Trash (Trash.java:<init>(232)) - The configured interval for checkpoint is 0 minutes. Using interval of 0 minutes that is used for deletion instead
2011-08-09 18:49:55,056 INFO  http.HttpServer (HttpServer.java:addGlobalFilter(297)) - Added global filtersafety (class=org.apache.hadoop.http.HttpServer$QuotingInputFilter)
2011-08-09 18:49:55,057 INFO  http.HttpServer (HttpServer.java:start(437)) - Port returned by webServer.getConnectors()[0].getLocalPort() before open() is -1. Opening the listener on 0
2011-08-09 18:49:55,057 INFO  http.HttpServer (HttpServer.java:start(442)) - listener.getLocalPort() returned 51161 webServer.getConnectors()[0].getLocalPort() returned 51161
2011-08-09 18:49:55,057 INFO  http.HttpServer (HttpServer.java:start(475)) - Jetty bound to port 51161
2011-08-09 18:49:55,057 INFO  mortbay.log (Slf4jLog.java:info(67)) - jetty-6.1.26
2011-08-09 18:49:55,133 INFO  mortbay.log (Slf4jLog.java:info(67)) - Started SelectChannelConnector@localhost:51161
2011-08-09 18:49:55,134 INFO  namenode.NameNode (NameNode.java:startHttpServer(329)) - Web-server up at: localhost:51161
Starting DataNode 0 with dfs.data.dir: /home/jeff/hadoop-20-warehouse/build/test/data/data1,/home/jeff/hadoop-20-warehouse/build/test/data/data2
2011-08-09 18:49:55,497 INFO  datanode.DataNode (DataNode.java:<init>(227)) - Failed to start datanode java.io.IOException: org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /home/jeff/hadoop-20-warehouse/build/test/data/data1 is in an inconsistent state: Cannot rollback to a newer state.
Datanode previous state: LV = -27 CTime = 9223372036854775807 is newer than the namespace state: LV = -27 CTime = 0
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.doRollback(DataStorage.java:373)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.doTransition(DataStorage.java:220)
	at org.apache.hadoop.hdfs.server.datanode.DataStorage.recoverTransitionRead(DataStorage.java:148)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.startDataNode(DataNode.java:308)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.<init>(DataNode.java:225)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.makeInstance(DataNode.java:1379)
	at org.apache.hadoop.hdfs.server.datanode.DataNode.instantiateDataNode(DataNode.java:1334)
	at org.apache.hadoop.hdfs.MiniDFSCluster.startDataNodes(MiniDFSCluster.java:485)
	at org.apache.hadoop.hdfs.MiniDFSCluster.startDataNodes(MiniDFSCluster.java:526)
	at org.apache.hadoop.hdfs.TestDFSRollback.startDataNodeShouldFail(TestDFSRollback.java:107)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:189)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
Caused by: org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /home/jeff/hadoop-20-warehouse/build/test/data/data1 is in an inconsistent state: Cannot rollback to a newer state.
Datanode previous state: LV = -27 CTime = 9223372036854775807 is newer than the namespace state: LV = -27 CTime = 0
	at org.apache.hadoop.hdfs.server.datanode.DataStorage$RollbackThread.run(DataStorage.java:404)

Shutting down the Mini HDFS Cluster
2011-08-09 18:49:55,499 INFO  mortbay.log (Slf4jLog.java:info(67)) - Stopped SelectChannelConnector@localhost:0
2011-08-09 18:49:55,500 WARN  namenode.FSNamesystem (FSNamesystem.java:run(3042)) - ReplicationMonitor thread received InterruptedException.java.lang.InterruptedException: sleep interrupted
2011-08-09 18:49:55,501 INFO  namenode.FSNamesystem (FSEditLog.java:printStatistics(1125)) - Number of transactions: 0 Total time for transactions(ms): 0 Number of transactions batched in Syncs: 0 Number of syncs: 0 SyncTimes(ms):  /home/jeff/hadoop-20-warehouse/build/test/data/name1/current/edits:0  /home/jeff/hadoop-20-warehouse/build/test/data/name2/current/edits:0 
2011-08-09 18:49:55,501 INFO  namenode.DecommissionManager (DecommissionManager.java:waitForWork(254)) - Interrupted Monitor
java.lang.InterruptedException
	at java.lang.Object.wait(Native Method)
	at java.lang.Object.wait(Object.java:485)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.waitForWork(DecommissionManager.java:244)
	at org.apache.hadoop.hdfs.server.namenode.DecommissionManager$Monitor.run(DecommissionManager.java:267)
	at java.lang.Thread.run(Thread.java:662)
2011-08-09 18:49:55,507 INFO  ipc.Server (Server.java:stop(1226)) - Stopping server on 60758
2011-08-09 18:49:55,508 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 1 on 60758: exiting
2011-08-09 18:49:55,509 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 0 on 60758: exiting
2011-08-09 18:49:55,510 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 3 on 60758: exiting
2011-08-09 18:49:55,509 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 4 on 60758: exiting
2011-08-09 18:49:55,509 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 2 on 60758: exiting
2011-08-09 18:49:55,509 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 6 on 60758: exiting
2011-08-09 18:49:55,509 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 8 on 60758: exiting
2011-08-09 18:49:55,509 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 9 on 60758: exiting
2011-08-09 18:49:55,509 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 7 on 60758: exiting
2011-08-09 18:49:55,509 INFO  ipc.Server (Server.java:run(1110)) - IPC Server handler 5 on 60758: exiting
2011-08-09 18:49:55,508 INFO  ipc.Server (Server.java:run(447)) - Stopping IPC Server listener on 60758
2011-08-09 18:49:55,508 INFO  ipc.Server (Server.java:run(646)) - Stopping IPC Server Responder
2011-08-09 18:49:55,515 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:55,515 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 16*** NameNode rollback with no edits file: numDirs=2
2011-08-09 18:49:55,573 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:55,576 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:55,577 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:55,577 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:55,577 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:55,577 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:55,584 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:55,585 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:55,585 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:55,585 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:55,589 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:55,589 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:55,590 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:55,593 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   new LV = -27; new CTime = 0
2011-08-09 18:49:55,594 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:55,594 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name2.
   new LV = -27; new CTime = 0
2011-08-09 18:49:55,594 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name2 is complete.
2011-08-09 18:49:55,595 ERROR namenode.FSNamesystem (FSNamesystem.java:<init>(347)) - FSNamesystem initialization failed.
java.io.IOException: Edits file is not found in [/home/jeff/hadoop-20-warehouse/build/test/data/name1, /home/jeff/hadoop-20-warehouse/build/test/data/name2]
	at org.apache.hadoop.hdfs.server.namenode.FSImage.loadFSImage(FSImage.java:935)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:457)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.loadFSImage(FSDirectory.java:151)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.initialize(FSNamesystem.java:369)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:345)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:273)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.<init>(NameNode.java:357)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1246)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:342)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:260)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:101)
	at org.apache.hadoop.hdfs.TestDFSRollback.startNameNodeShouldFail(TestDFSRollback.java:94)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:200)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
2011-08-09 18:49:55,596 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:55,596 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 17*** NameNode rollback with no image file: numDirs=2
2011-08-09 18:49:55,648 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:55,651 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:55,651 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:55,651 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:55,651 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:55,651 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:55,655 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:55,655 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:55,655 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:55,655 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:55,658 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:55,659 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:55,659 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:55,673 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name1.
   new LV = -27; new CTime = 0
2011-08-09 18:49:55,674 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name1 is complete.
2011-08-09 18:49:55,674 INFO  common.Storage (FSImage.java:doRollback(554)) - Rolling back storage directory /home/jeff/hadoop-20-warehouse/build/test/data/name2.
   new LV = -27; new CTime = 0
2011-08-09 18:49:55,674 INFO  common.Storage (FSImage.java:doRollback(568)) - Rollback of /home/jeff/hadoop-20-warehouse/build/test/data/name2 is complete.
2011-08-09 18:49:55,675 ERROR namenode.FSNamesystem (FSNamesystem.java:<init>(347)) - FSNamesystem initialization failed.
java.io.IOException: Image file is not found in [/home/jeff/hadoop-20-warehouse/build/test/data/name1, /home/jeff/hadoop-20-warehouse/build/test/data/name2]
	at org.apache.hadoop.hdfs.server.namenode.FSImage.loadFSImage(FSImage.java:933)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:457)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.loadFSImage(FSDirectory.java:151)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.initialize(FSNamesystem.java:369)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:345)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:273)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.<init>(NameNode.java:357)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1246)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:342)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:260)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:101)
	at org.apache.hadoop.hdfs.TestDFSRollback.startNameNodeShouldFail(TestDFSRollback.java:94)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:209)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
2011-08-09 18:49:55,676 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:55,676 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 18*** NameNode rollback with corrupt version file: numDirs=2
2011-08-09 18:49:55,833 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:55,836 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:55,836 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:55,837 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:55,837 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:55,837 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:55,842 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:55,843 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:55,843 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:55,843 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:55,846 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:55,847 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:55,847 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:55,850 ERROR namenode.FSNamesystem (FSNamesystem.java:<init>(347)) - FSNamesystem initialization failed.
org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /home/jeff/hadoop-20-warehouse/build/test/data/name1 is in an inconsistent state: file VERSION is invalid.
	at org.apache.hadoop.hdfs.server.common.Storage.getFields(Storage.java:647)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.getFields(FSImage.java:636)
	at org.apache.hadoop.hdfs.server.common.Storage$StorageDirectory.read(Storage.java:238)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.doRollback(FSImage.java:538)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:452)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.loadFSImage(FSDirectory.java:151)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.initialize(FSNamesystem.java:369)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:345)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:273)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.<init>(NameNode.java:357)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1246)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:342)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:260)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:101)
	at org.apache.hadoop.hdfs.TestDFSRollback.startNameNodeShouldFail(TestDFSRollback.java:94)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:218)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
2011-08-09 18:49:55,852 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(53)) - ============================================================
2011-08-09 18:49:55,852 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:log(54)) - ***TEST 19*** NameNode rollback with old layout version in previous: numDirs=2
2011-08-09 18:49:55,942 INFO  jvm.JvmMetrics (JvmMetrics.java:init(66)) - Cannot initialize JVM Metrics with processName=NameNode, sessionId=null - already initialized
2011-08-09 18:49:55,946 INFO  metrics.NameNodeMetrics (NameNodeMetrics.java:<init>(145)) - Initializing NameNodeMeterics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:55,946 INFO  util.GSet (BlocksMap.java:computeCapacity(342)) - VM type       = 64-bit
2011-08-09 18:49:55,946 INFO  util.GSet (BlocksMap.java:computeCapacity(343)) - 2% max memory = 9.89875 MB
2011-08-09 18:49:55,946 INFO  util.GSet (BlocksMap.java:computeCapacity(344)) - capacity      = 2^20 = 1048576 entries
2011-08-09 18:49:55,947 INFO  util.GSet (LightWeightGSet.java:<init>(79)) - recommended=1048576, actual=1048576
2011-08-09 18:49:55,952 WARN  namenode.FSNamesystem (ConfigManager.java:<init>(56)) - No whitelist file specified in dfs.namenode.whitelist.file. The namenode will allow deletion/renaming of any directory.
2011-08-09 18:49:55,952 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(521)) - fsOwner=jeff,jeff
2011-08-09 18:49:55,952 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(527)) - supergroup=supergroup
2011-08-09 18:49:55,952 INFO  namenode.FSNamesystem (FSNamesystem.java:setConfigurationParameters(528)) - isPermissionEnabled=true
2011-08-09 18:49:55,956 INFO  metrics.FSNamesystemMetrics (FSNamesystemMetrics.java:<init>(71)) - Initializing FSNamesystemMetrics using context object:org.apache.hadoop.metrics.spi.NullContext
2011-08-09 18:49:55,956 INFO  namenode.FSNamesystem (FSNamesystem.java:registerMBean(5940)) - Registered FSNamesystemStatusMBean
2011-08-09 18:49:55,956 INFO  namenode.NameNode (FSDirectory.java:<init>(126)) - Caching file names occuring more than 10 times 
2011-08-09 18:49:55,961 ERROR namenode.FSNamesystem (FSNamesystem.java:<init>(347)) - FSNamesystem initialization failed.
org.apache.hadoop.hdfs.server.common.InconsistentFSStateException: Directory /home/jeff/hadoop-20-warehouse/build/test/data/name1 is in an inconsistent state: previous fs state should not exist during upgrade. Finalize or rollback first.
	at org.apache.hadoop.hdfs.server.namenode.FSImage.doUpgrade(FSImage.java:474)
	at org.apache.hadoop.hdfs.server.namenode.FSImage.recoverTransitionRead(FSImage.java:446)
	at org.apache.hadoop.hdfs.server.namenode.FSDirectory.loadFSImage(FSDirectory.java:151)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.initialize(FSNamesystem.java:369)
	at org.apache.hadoop.hdfs.server.namenode.FSNamesystem.<init>(FSNamesystem.java:345)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.initialize(NameNode.java:273)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.<init>(NameNode.java:357)
	at org.apache.hadoop.hdfs.server.namenode.NameNode.createNameNode(NameNode.java:1246)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:342)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:260)
	at org.apache.hadoop.hdfs.MiniDFSCluster.<init>(MiniDFSCluster.java:101)
	at org.apache.hadoop.hdfs.TestDFSRollback.startNameNodeShouldFail(TestDFSRollback.java:94)
	at org.apache.hadoop.hdfs.TestDFSRollback.testRollback(TestDFSRollback.java:228)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:597)
	at junit.framework.TestCase.runTest(TestCase.java:168)
	at junit.framework.TestCase.runBare(TestCase.java:134)
	at junit.framework.TestResult$1.protect(TestResult.java:110)
	at junit.framework.TestResult.runProtected(TestResult.java:128)
	at junit.framework.TestResult.run(TestResult.java:113)
	at junit.framework.TestCase.run(TestCase.java:124)
	at junit.framework.TestSuite.runTest(TestSuite.java:232)
	at junit.framework.TestSuite.run(TestSuite.java:227)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:79)
	at junit.framework.JUnit4TestAdapter.run(JUnit4TestAdapter.java:39)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.run(JUnitTestRunner.java:421)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.launch(JUnitTestRunner.java:912)
	at org.apache.tools.ant.taskdefs.optional.junit.JUnitTestRunner.main(JUnitTestRunner.java:766)
2011-08-09 18:49:56,066 INFO  hdfs.TestDFSRollback (TestDFSRollback.java:tearDown(234)) - Shutting down MiniDFSCluster
Shutting down the Mini HDFS Cluster
------------- ---------------- ---------------

Testcase: testRollback took 18.718 sec
